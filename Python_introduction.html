
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>First steps &#8212; Introduction to Python</title>
    
  <link href="_static/css/theme.css" rel="stylesheet" />
  <link href="_static/css/index.c5995385ac14fb8791e8eb36b4908be2.css" rel="stylesheet" />

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="_static/js/index.1c5a1a01449ed65a7b51.js">

    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/togglebutton.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="index.html">
      
      
      
      <h1 class="site-logo" id="site-title">Introduction to Python</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1 current">
  <a class="reference internal" href="#">
   First steps
  </a>
 </li>
</ul>
    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="_sources/Python_introduction.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/executablebooks/jupyter-book"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2FPython_introduction.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/executablebooks/jupyter-book/master?urlpath=tree/docs/Python_introduction.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   First steps
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#basic-python">
     Basic Python
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#help">
       Help
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#data-types">
       Data Types
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#packages-and-modules">
     Packages and Modules
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#variables">
     Variables
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#logical-conditions">
     Logical Conditions
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#branching">
     Branching
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#lists-and-tuples">
     Lists and Tuples
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#dictionaries">
     Dictionaries
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#un-packing">
     (Un)packing
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#loops">
     Loops
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#for-loop">
       for-loop
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#while-loop">
       while-loop
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#list-comprehension">
     List comprehension
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#break-and-continue">
       break and continue
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#functions">
     Functions
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#return">
       Return
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#yield">
       Yield
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#global-and-local-variables">
       Global and Local Variables
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#lambda-functions">
     Lambda functions
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#callbacks">
     Callbacks
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#decorators">
     Decorators
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#classes">
     Classes
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#inheritance">
       Inheritance
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#files">
     Files
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#second-steps">
   Second steps
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#numpy">
     NumPy
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#working-with-data">
   Working with Data
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#pandas-dataframes-and-series">
     Pandas - DataFrames and Series
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#indexing">
       Indexing
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#useful-methods">
       Useful Methods
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#plots">
       Plots
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#importing-and-exporting-data">
       Importing and Exporting Data
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#scikit-learn">
   SciKit Learn
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#data-manipulation">
     Data manipulation
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#regression">
     Regression
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#linear-regression">
       Linear Regression
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#digression-statsmodels">
       Digression: statsmodels
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#supervised-learning-random-forests">
     Supervised learning: Random Forests
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#tensorflow-keras">
   TensorFlow: Keras
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#a-more-complex-model">
     A more complex model
    </a>
   </li>
  </ul>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="first-steps">
<h1>First steps<a class="headerlink" href="#first-steps" title="Permalink to this headline">¶</a></h1>
<p>This chapter provides an introduction to basic commands and useful built-in libraries.</p>
<p>As mentioned, this course will rely on jupyter notebooks. Code will be written in cells, which can be run independently.
To run a cell, one can use the run symbol above the cells by clicking on it. A more convenient way is again using the corresponding keyboard shortcut: holding <strong>shift</strong> and  pressing <strong>enter</strong>.<br />
This will run the current cell and select the next cell below.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">sys</span>
<span class="n">sys</span><span class="o">.</span><span class="n">version</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;3.8.8 (v3.8.8:024d8058b0, Feb 19 2021, 08:48:17) \n[Clang 6.0 (clang-600.0.57)]&#39;
</pre></div>
</div>
</div>
</div>
<div class="section" id="basic-python">
<h2>Basic Python<a class="headerlink" href="#basic-python" title="Permalink to this headline">¶</a></h2>
<p>Just starting a jupyter notebook and thus a python kernel already allows several basic operations. The perhaps most obvious functionality would be to use a cell to calculate a mathematical expression. To do so, just enter the expression and run the cell:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="mi">999</span><span class="o">+</span><span class="mi">1</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1000
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># comments inside the cell, starting with &#39;#&#39; help readers to understand your code. </span>
<span class="c1"># These lines are not run! </span>
<span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="mi">4</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>4
</pre></div>
</div>
</div>
</div>
<p>While jupyter will print the result of such one line expressions immediately, writing both expressions in one cell will print only the last computed result:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="mi">999</span><span class="o">+</span><span class="mi">1</span>
<span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="mi">4</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>4
</pre></div>
</div>
</div>
</div>
<p>In the common case, where code inside one cell will exceed one line or will produce more than just on result, the <code class="docutils literal notranslate"><span class="pre">print()</span></code> function can be used. Functions in python get their parameters in parentheses (more on functions later):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="mi">999</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="mi">4</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1000
4
</pre></div>
</div>
</div>
</div>
<p>Some basic operations and functions are</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Addition:&#39;</span><span class="p">,</span>       <span class="mi">1</span> <span class="o">+</span> <span class="mi">1</span> <span class="p">)</span>      
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Subtraction:&#39;</span><span class="p">,</span>    <span class="mi">2</span> <span class="o">-</span> <span class="mi">1</span> <span class="p">)</span>      
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Division:&#39;</span><span class="p">,</span>       <span class="mi">1</span> <span class="o">*</span> <span class="mi">2</span> <span class="p">)</span>      
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Multiplication:&#39;</span><span class="p">,</span> <span class="mi">2</span> <span class="o">/</span> <span class="mi">1</span> <span class="p">)</span>      
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Modulus:&#39;</span><span class="p">,</span>        <span class="mi">3</span> <span class="o">%</span> <span class="mi">2</span> <span class="p">)</span>      
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Floor division:&#39;</span><span class="p">,</span> <span class="mi">5</span> <span class="o">//</span> <span class="mi">2</span> <span class="p">)</span>     
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Exponent:&#39;</span><span class="p">,</span>       <span class="mi">2</span> <span class="o">**</span> <span class="mi">3</span> <span class="p">)</span>     
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Minimum:&#39;</span><span class="p">,</span>       <span class="nb">min</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Maximum:&#39;</span><span class="p">,</span>       <span class="nb">max</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Addition: 2
Subtraction: 1
Division: 2
Multiplication: 2.0
Modulus: 1
Floor division: 2
Exponent: 8
Minimum: 2
Maximum: 5
</pre></div>
</div>
</div>
</div>
<p>Autocompletion is a very useful tool for writing code. Not only will it provide already defined variables. It will also show you available methods on different objects (more on objects later).</p>
<p>Autocompletion or suggestions for completion will appear when pressing <strong>tab</strong> in code, as long as it is not the beginning of a line (where it will indent the line, see loops, functions).<br />
For instance, when typing <code class="docutils literal notranslate"><span class="pre">pri</span></code> and hitting <strong>tab</strong>, jupyter will complete it to <code class="docutils literal notranslate"><span class="pre">print</span></code>.</p>
<div class="section" id="help">
<h3>Help<a class="headerlink" href="#help" title="Permalink to this headline">¶</a></h3>
<p>In order to get information, for example on the <code class="docutils literal notranslate"><span class="pre">print()</span></code>function, help can be summoned by using yet another function:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">help</span><span class="p">(</span><span class="nb">print</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Help on built-in function print in module builtins:

print(...)
    print(value, ..., sep=&#39; &#39;, end=&#39;\n&#39;, file=sys.stdout, flush=False)
    
    Prints the values to a stream, or to sys.stdout by default.
    Optional keyword arguments:
    file:  a file-like object (stream); defaults to the current sys.stdout.
    sep:   string inserted between values, default a space.
    end:   string appended after the last value, default a newline.
    flush: whether to forcibly flush the stream.
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="data-types">
<h3>Data Types<a class="headerlink" href="#data-types" title="Permalink to this headline">¶</a></h3>
<p>The most basic data types in python are numeric, string and boolean. However, there are many, many more. In order for many operations wo work properly, the data types must be compatible with one another. With the <code class="docutils literal notranslate"><span class="pre">type()</span></code> function the datatype of an object can be printed.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">b</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="n">c</span> <span class="o">=</span> <span class="s1">&#39;two&#39;</span>
<span class="n">d</span> <span class="o">=</span> <span class="kc">True</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;a:&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">a</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;b:&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">b</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;c:&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">c</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;d:&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">d</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>a: &lt;class &#39;int&#39;&gt;
b: &lt;class &#39;float&#39;&gt;
c: &lt;class &#39;str&#39;&gt;
d: &lt;class &#39;bool&#39;&gt;
</pre></div>
</div>
</div>
</div>
<p>Changing the type of a variable can be achieved by the respective functions:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="mf">3.14</span><span class="p">))</span>

<span class="n">f</span> <span class="o">=</span> <span class="s2">&quot;2.5&quot;</span>
<span class="nb">print</span><span class="p">(</span><span class="mi">10</span> <span class="o">+</span> <span class="nb">float</span><span class="p">(</span><span class="n">f</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3
12.5
</pre></div>
</div>
</div>
</div>
<p>Some mathematical operations can also be applied to strings/lists:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="s1">&#39;Who would &#39;</span>
<span class="n">b</span> <span class="o">=</span> <span class="s1">&#39;have thought&#39;</span>
<span class="n">c</span> <span class="o">=</span> <span class="s1">&#39;?&#39;</span>
<span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="o">+</span><span class="n">b</span><span class="o">+</span><span class="p">(</span><span class="n">c</span><span class="o">*</span><span class="mi">5</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Who would have thought?????
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="packages-and-modules">
<h2>Packages and Modules<a class="headerlink" href="#packages-and-modules" title="Permalink to this headline">¶</a></h2>
<p>Python’s functionality can be expanded by loading modules to the namespace. A module may be seen as a chunk of python code for a special task someone has already written for you to use while package signifies the inclusion of the underlying file structure to load the modules.</p>
<p>In order to make a module’s complete functionality available, it has to be loaded to the namespace trailing the <code class="docutils literal notranslate"><span class="pre">import</span></code> statement. Calling a module function in this case requires the module name with a dot before the function: <code class="docutils literal notranslate"><span class="pre">package.function()</span></code>.</p>
<p>A module can be imported under an alias, using the <code class="docutils literal notranslate"><span class="pre">as</span></code> statement. This can help someone reading your code to know from which module a function is imported while keeping the code shorter and thus better readable.</p>
<div class="tip admonition">
<p class="admonition-title">Tip</p>
<p>By convention all imports are done at the beginning of the code.</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">math</span>
<span class="nb">print</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mf">4.0</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2.0
2.0
</pre></div>
</div>
</div>
</div>
<p>To import a single function (or class) from a module one calls <code class="docutils literal notranslate"><span class="pre">from</span> <span class="pre">&lt;module&gt;</span> <span class="pre">import</span> <span class="pre">&lt;function&gt;</span></code>. Here, the module’s name does not need to be added when calling the function. Similarly, an asterisk can be used as a wild card, as in <code class="docutils literal notranslate"><span class="pre">from</span> <span class="pre">&lt;package&gt;</span> <span class="pre">import</span> <span class="pre">*</span></code>, to import all functions (classes) from one module (so not to add the module prefix every time in the code). <br />
The following examples uses the <code class="docutils literal notranslate"><span class="pre">math</span></code> module, which contains functions such as the sine, cosine or square root.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">math</span> <span class="kn">import</span> <span class="n">sqrt</span>
<span class="nb">print</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2.0
</pre></div>
</div>
</div>
</div>
<div class="admonition-note admonition">
<p class="admonition-title">Note</p>
<p>Calling a function which is not imported results in an error.</p>
<p>Usually, python is rather explicit in where to look for your mistake.</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#print(cos(0))    # would raise error as cos() function is not imported</span>
</pre></div>
</div>
</div>
</div>
<p><img alt="" src="_images/cos_error.png" /></p>
<p>With the wild card, all functions from the math module are now loaded to the namespace.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">math</span> <span class="kn">import</span> <span class="o">*</span>
<span class="n">cos</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1.0
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="variables">
<h2>Variables<a class="headerlink" href="#variables" title="Permalink to this headline">¶</a></h2>
<p>Objects can be stored in variables by assigning them using <code class="docutils literal notranslate"><span class="pre">=</span></code>. Since everything in python is an object, anything can be saved in a variable: numbers, strings, lists, etc. Python will automatically recognize the format of a variable to let the user know about incompatibilities. Calling a variable before it is assigned will also throw an error.<br />
Note that python is case sensitive, meaning that when assigning variables a ≠ A.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">var_1</span> <span class="o">=</span> <span class="mi">5</span> <span class="o">**</span> <span class="mi">2</span>
<span class="nb">print</span><span class="p">(</span><span class="n">var_1</span><span class="p">)</span>
<span class="n">var_2</span> <span class="o">=</span> <span class="s1">&#39;twenty five&#39;</span>
<span class="nb">print</span><span class="p">(</span><span class="n">var_2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>25
twenty five
</pre></div>
</div>
</div>
</div>
<div class="caution admonition">
<p class="admonition-title">Caution</p>
<p>Do not name your variables like built-in python objects!</p>
</div>
<p>In jupyter notebooks, built-in objects are automatically coloured green.
For example:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">list</span>
<span class="nb">int</span>
<span class="nb">dict</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>dict
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="logical-conditions">
<h2>Logical Conditions<a class="headerlink" href="#logical-conditions" title="Permalink to this headline">¶</a></h2>
<p>In order to compare values, logical operators can be used. The most common are</p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="text-align:left head"><p>Operator</p></th>
<th class="text-align:right head"><p>Meaning</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-align:left"><p>==</p></td>
<td class="text-align:right"><p>equal</p></td>
</tr>
<tr class="row-odd"><td class="text-align:left"><p>1!=</p></td>
<td class="text-align:right"><p>not equal</p></td>
</tr>
<tr class="row-even"><td class="text-align:left"><p>&gt;</p></td>
<td class="text-align:right"><p>greater than</p></td>
</tr>
<tr class="row-odd"><td class="text-align:left"><p>&lt;</p></td>
<td class="text-align:right"><p>less than</p></td>
</tr>
<tr class="row-even"><td class="text-align:left"><p>&gt;=</p></td>
<td class="text-align:right"><p>greater than or equal to</p></td>
</tr>
<tr class="row-odd"><td class="text-align:left"><p>&lt;=</p></td>
<td class="text-align:right"><p>less than or equal to</p></td>
</tr>
</tbody>
</table>
<p>The result will be a boolean: either <code class="docutils literal notranslate"><span class="pre">True</span></code> or <code class="docutils literal notranslate"><span class="pre">False</span></code>. <br />
Comparing statements may also be combined by <code class="docutils literal notranslate"><span class="pre">and</span></code> or <code class="docutils literal notranslate"><span class="pre">or</span></code> and can be negated by <code class="docutils literal notranslate"><span class="pre">not</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">&lt;</span><span class="mi">2</span><span class="p">)</span>
<span class="n">b</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">a</span> <span class="ow">and</span> <span class="n">b</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">a</span> <span class="ow">or</span> <span class="n">b</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>True False
False
True
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="branching">
<h2>Branching<a class="headerlink" href="#branching" title="Permalink to this headline">¶</a></h2>
<p>In a program, code must often be run conditionally on some input or previous result. The <code class="docutils literal notranslate"><span class="pre">if</span></code>, <code class="docutils literal notranslate"><span class="pre">else</span></code> and <code class="docutils literal notranslate"><span class="pre">elif</span></code>statement can be used to select which branch of code shall be run. The condition is followed by a colon and the respective code for that condition must be indented (automatically with a line break or by pressing <em><strong>tab</strong></em>).</p>
<div class="caution admonition">
<p class="admonition-title">Caution</p>
<p>Indentation is not to be used for better readability.</p>
<p>Instead, it has a function and must not be used when not necessary!</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="mi">4</span>

<span class="k">if</span> <span class="n">a</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;a is negative&#39;</span><span class="p">)</span>
<span class="k">elif</span> <span class="n">a</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;a is positive&#39;</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;a equals zero&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>a is positive
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="lists-and-tuples">
<h2>Lists and Tuples<a class="headerlink" href="#lists-and-tuples" title="Permalink to this headline">¶</a></h2>
<p>Lists and tuples are both an ordered collection of objects. While tuples cannot be modified, lists are rather flexible. Objects can be added to a list, removed or replaced. Lists appear in square brackets <code class="docutils literal notranslate"><span class="pre">[]</span></code>, tuples in parentheses <code class="docutils literal notranslate"><span class="pre">()</span></code>.  <br />
Lists and tuples can be nested, meaning elements of a list or tuple can again be a list or tuple. Duplicates are also allowed. (A <code class="docutils literal notranslate"><span class="pre">set()</span></code> would not allow duplicates and is not ordered). <br />
Elements can be accessed by indexing with square brackets behind the list name.</p>
<div class="admonition-note admonition">
<p class="admonition-title">Note</p>
<p>Indexing in python starts with zero, so the first element of a list will have index 0.</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">my_list</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">]</span>
<span class="n">my_tuple</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">)</span>

<span class="c1"># length of object:</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;0. the length of my list is&#39;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">my_list</span><span class="p">),</span><span class="s1">&#39;, the length of the word &quot;list&quot;&#39;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="s1">&#39;list&#39;</span><span class="p">))</span>

<span class="c1"># access first element</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;1. first element from my_list:&#39;</span><span class="p">,</span> <span class="n">my_list</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

<span class="c1"># print variables more conveniently</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;2. second element of my_tuple: </span><span class="si">{</span><span class="n">my_tuple</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="c1"># to change an element</span>
<span class="n">my_list</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mi">3</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;3. changing the third element in my_list: </span><span class="si">{</span><span class="n">my_list</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="c1"># note that strings are lists of characters:</span>
<span class="n">my_str</span> <span class="o">=</span> <span class="s1">&#39;expression&#39;</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;4. first letter in my_str: </span><span class="si">{</span><span class="n">my_str</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="c1"># last element </span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;5. last element of my_tuple: </span><span class="si">{</span><span class="n">my_tuple</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="c1"># slicing</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;6. from element 3 to end of my_list: </span><span class="si">{</span><span class="n">my_list</span><span class="p">[</span><span class="mi">2</span><span class="p">:]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="c1"># reverse order</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;7. reverse order of my_list and slice: </span><span class="si">{</span><span class="n">my_list</span><span class="p">[</span><span class="mi">3</span><span class="p">::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="c1"># delete element</span>
<span class="k">del</span><span class="p">(</span><span class="n">my_list</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;8. add new element: </span><span class="si">{</span><span class="n">my_list</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0. the length of my list is 5 , the length of the word &quot;list&quot; 4
1. first element from my_list: 1
2. second element of my_tuple: b
3. changing the third element in my_list: [1, 2, 3, 4, 5]
4. first letter in my_str: e
5. last element of my_tuple: c
6. from element 3 to end of my_list: [3, 4, 5]
7. reverse order of my_list and slice: [4, 3, 2, 1]
8. add new element: [1, 2, 3, 4]
</pre></div>
</div>
</div>
</div>
<p>Lists also allow for element checks using <code class="docutils literal notranslate"><span class="pre">in</span></code> (negated by <code class="docutils literal notranslate"><span class="pre">not</span></code>):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">my_list</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">]</span>

<span class="k">if</span> <span class="mi">2</span> <span class="ow">in</span> <span class="n">my_list</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;2 is an element of my_list&#39;</span><span class="p">)</span>
    
<span class="k">if</span> <span class="mi">10</span> <span class="ow">in</span> <span class="n">my_list</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;10 is an element of my_list&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2 is an element of my_list
</pre></div>
</div>
</div>
</div>
<p>Beside definition by hand, the the functions <code class="docutils literal notranslate"><span class="pre">list()</span></code> and <code class="docutils literal notranslate"><span class="pre">tuple()</span></code> can be used to transform a suitable object to a list or tuple.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="n">my_list</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="s1">&#39;python&#39;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(1, 2, 3, 4)
[&#39;p&#39;, &#39;y&#39;, &#39;t&#39;, &#39;h&#39;, &#39;o&#39;, &#39;n&#39;]
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="dictionaries">
<h2>Dictionaries<a class="headerlink" href="#dictionaries" title="Permalink to this headline">¶</a></h2>
<p>Dictionaries allow to store <em>key - value</em> pairs in a kind of named list fashion. By convention the <em>key</em> element is of type string, while the <em>value</em> can be any object (including dictionaries). To define a dictionary, inside curly braces <code class="docutils literal notranslate"><span class="pre">{}</span></code>, the <em>key</em> element is followed by a colon and the <em>value</em>. The <em>keys</em> must be unique in a dictionary, since the <em>value</em> elements are accessed via the respective <em>key</em>: as in lists, one uses square brackets. Yet not with an index number but the desired <em>key</em>.<br />
New key-value pairs can be added to a dict in a similar way as they are accessed. The new <em>key</em> in square brackets follows the dict name and a <em>value</em> is assigned by an equal sign.<br />
Dictionaries are not ordered, as can be seen from the way of accessing and adding new k-v pairs.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">my_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;start&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;end&#39;</span><span class="p">:</span> <span class="mi">20</span><span class="p">}</span>
<span class="nb">print</span><span class="p">(</span><span class="n">my_dict</span><span class="p">[</span><span class="s1">&#39;start&#39;</span><span class="p">])</span>

<span class="c1"># new k-v pair</span>
<span class="n">my_dict</span><span class="p">[</span><span class="s1">&#39;mid&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">10</span>
<span class="nb">print</span><span class="p">(</span><span class="n">my_dict</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1
{&#39;start&#39;: 1, &#39;end&#39;: 20, &#39;mid&#39;: 10}
</pre></div>
</div>
</div>
</div>
<p>All <em>keys</em> and <em>value</em> can be accessed with the <code class="docutils literal notranslate"><span class="pre">.keys()</span></code> and <code class="docutils literal notranslate"><span class="pre">.values()</span></code> method (more on methods later).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">my_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span> <span class="n">my_dict</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>dict_keys([&#39;start&#39;, &#39;end&#39;, &#39;mid&#39;]) dict_values([1, 20, 10])
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="un-packing">
<h2>(Un)packing<a class="headerlink" href="#un-packing" title="Permalink to this headline">¶</a></h2>
<p>Python allows to assign multiple variables at once, called (un)packing. This is most common with tuples but can be expanded to other iterables. The variables to be assigned are separated by a comma.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">my_tuple</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;one&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;three&#39;</span><span class="p">)</span>
<span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="n">my_tuple</span>
<span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span>

<span class="c1"># the asterisk assigns all surplus values on the right hand side of the equal sign to a</span>
<span class="o">*</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span>
<span class="nb">print</span><span class="p">(</span><span class="n">a</span> <span class="p">,</span><span class="n">b</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>one 2 three
[1, 2, 3] 4
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="loops">
<h2>Loops<a class="headerlink" href="#loops" title="Permalink to this headline">¶</a></h2>
<div class="section" id="for-loop">
<h3>for-loop<a class="headerlink" href="#for-loop" title="Permalink to this headline">¶</a></h3>
<p>A for-loop is used for iteration, if the number of iterations is known prior to execution. A for loop iterates over any sequence like lists, tuples, strings etc. A common way is to loop over a <code class="docutils literal notranslate"><span class="pre">range(n)</span></code> object. Caution: indexing starts from 0 and for range objects ends at <code class="docutils literal notranslate"><span class="pre">n-1</span></code>!\</p>
<p>Note that when iterating a list or tuple it might be worth considering to choose an informative name (especially when nesting loops).\</p>
<p>To write a loop, <code class="docutils literal notranslate"><span class="pre">for</span></code> is followed by the iterating variable, <code class="docutils literal notranslate"><span class="pre">in</span></code> and the sequence to iterate before a colon. The code to execute every step begins in the next line and is indented.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># range object for iterating numbers</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1"> squared is </span><span class="si">{</span><span class="n">i</span><span class="o">**</span><span class="mi">2</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>  
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>

<span class="c1"># iterate over a tuple/list</span>
<span class="k">for</span> <span class="n">tuple_element</span> <span class="ow">in</span> <span class="n">my_tuple</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">tuple_element</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="c1"># iterate over tuple/list element and index</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">tup_el</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">my_tuple</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">tup_el</span><span class="si">}</span><span class="s1"> at position </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>  
<span class="c1"># iterate over keys and values in dict</span>
<span class="k">for</span> <span class="n">k</span><span class="p">,</span><span class="n">v</span> <span class="ow">in</span> <span class="n">my_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;key: </span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s1">, value: </span><span class="si">{</span><span class="n">v</span><span class="si">}</span><span class="s1"> &#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0 squared is 0
1 squared is 1
2 squared is 4
3 squared is 9
4 squared is 16

one
2
three

one at position 0
2 at position 1
three at position 2

key: start, value: 1 
key: end, value: 20 
key: mid, value: 10 
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="while-loop">
<h3>while-loop<a class="headerlink" href="#while-loop" title="Permalink to this headline">¶</a></h3>
<p>When the number of iterations for a loop is not known beforehand, a while-loop can be used. It will run, until a terminal state is reached or some criterion is satisfied. Usually, an initial state is given which will be altered by some operation and thus lead to termination.<br />
A while-loop start with <code class="docutils literal notranslate"><span class="pre">while</span></code> followed by the condition and a colon. The condition may be negated with <code class="docutils literal notranslate"><span class="pre">not</span></code>.\</p>
<div class="warning admonition">
<p class="admonition-title">Warning</p>
<p>Infinite loops may occur when the terminal criterion is not properly defined or the code is otherwise defective.</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">while</span> <span class="n">a</span> <span class="o">&lt;</span> <span class="mi">4</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
    <span class="c1"># use combined operator a += 1, equal to a = a + 1</span>
    <span class="n">a</span> <span class="o">+=</span> <span class="mi">1</span>      <span class="c1"># when not including this line, a will forever stay a = 0 and the loop will not terminate by itself</span>
                <span class="c1"># What will be printed in this case?</span>
    
<span class="n">var</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">check</span> <span class="o">=</span> <span class="kc">True</span>
<span class="k">while</span> <span class="n">check</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">var</span><span class="si">}</span><span class="s1"> is greater zero&#39;</span><span class="p">)</span>
    <span class="n">var</span> <span class="o">-=</span> <span class="mi">1</span> 
    <span class="n">check</span> <span class="o">=</span> <span class="n">var</span> <span class="o">&gt;</span> <span class="mi">0</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0
1
2
3
5 is greater zero
4 is greater zero
3 is greater zero
2 is greater zero
1 is greater zero
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="list-comprehension">
<h2>List comprehension<a class="headerlink" href="#list-comprehension" title="Permalink to this headline">¶</a></h2>
<p>Python offers a handy way to create lists. It looks like a for-loop in a list and is called list comprehension. It is written in one line instead of indenting as in ordinary for-loops. These expression can also be nested.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">list_1</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">)]</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;list_1:&#39;</span><span class="p">,</span> <span class="n">list_1</span><span class="p">)</span>

<span class="c1"># a nested expression</span>
<span class="n">list_2</span> <span class="o">=</span> <span class="p">[[</span><span class="n">i</span><span class="o">*</span><span class="n">j</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">list_1</span><span class="p">]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]]</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;list_2:&#39;</span><span class="p">,</span> <span class="n">list_2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>list_1: [0, 1, 2, 3, 4]
list_2: [[0, 0, 0, 0, 0], [0, 1, 2, 3, 4]]
</pre></div>
</div>
</div>
</div>
<div class="section" id="break-and-continue">
<h3>break and continue<a class="headerlink" href="#break-and-continue" title="Permalink to this headline">¶</a></h3>
<p>For more control over a loop, the <code class="docutils literal notranslate"><span class="pre">break</span></code>and <code class="docutils literal notranslate"><span class="pre">continue</span></code> statements can be engaged. Used with a condition, <code class="docutils literal notranslate"><span class="pre">break</span></code> will terminate the loop when satisfied while <code class="docutils literal notranslate"><span class="pre">continue</span></code> will stop and skip the current iteration to jump to the next.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">100</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">i</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>    <span class="c1"># % is the modulo operator</span>
        <span class="k">continue</span>      <span class="c1"># continue in the if-statement skips printing for odd i</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1"> is even&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">8</span><span class="p">:</span>        <span class="c1"># when i equals 8, the loop terminates (the print statement for i == 8 is executed before)</span>
        <span class="k">break</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0 is even
2 is even
4 is even
6 is even
8 is even
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="functions">
<h2>Functions<a class="headerlink" href="#functions" title="Permalink to this headline">¶</a></h2>
<p>Python come with many built in functions, some of which have been shown or used before, as well as the option to define new functions.</p>
<p>To define a function, use <code class="docutils literal notranslate"><span class="pre">def</span> <span class="pre">function_name(args):</span></code> before the indented body of the function begins in a new line. <code class="docutils literal notranslate"><span class="pre">args</span></code> here means arguments, which are passed to function.</p>
<p>Note that a function must not necessarily be defined using arguments.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">my_print</span><span class="p">(</span><span class="n">word</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">word</span><span class="p">)</span>
    
<span class="n">my_print</span><span class="p">(</span><span class="s1">&#39;Greetings&#39;</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">print_hi</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;hi&#39;</span><span class="p">)</span>
    
<span class="n">print_hi</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Greetings
hi
</pre></div>
</div>
</div>
</div>
<div class="section" id="return">
<h3>Return<a class="headerlink" href="#return" title="Permalink to this headline">¶</a></h3>
<p>To assign the result of a function to a variable for further use, the <code class="docutils literal notranslate"><span class="pre">return</span></code> keyword is used. If more than one object is to be returned, use commas to separate them.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">return</span></code> statement is indented at least once from <code class="docutils literal notranslate"><span class="pre">def</span></code>, even more than once when using branching, for example.
With branching, several return statements may appear in one function.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">return</span></code> command must not be confused with a <code class="docutils literal notranslate"><span class="pre">print()</span></code> statement!</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">data</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>

<span class="k">def</span> <span class="nf">my_mean</span><span class="p">(</span><span class="n">arg_list</span><span class="p">):</span>
    <span class="n">sum_</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">length_count</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">el</span> <span class="ow">in</span> <span class="n">arg_list</span><span class="p">:</span>
        <span class="n">sum_</span> <span class="o">+=</span> <span class="n">el</span>
        <span class="n">length_count</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="n">sum_</span><span class="o">/</span><span class="n">length_count</span>

<span class="nb">print</span><span class="p">(</span><span class="n">my_mean</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>4.0
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>4.0
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="yield">
<h3>Yield<a class="headerlink" href="#yield" title="Permalink to this headline">¶</a></h3>
<p>Besides <code class="docutils literal notranslate"><span class="pre">return</span></code>, another option is <code class="docutils literal notranslate"><span class="pre">yield</span></code>. The main difference is that <code class="docutils literal notranslate"><span class="pre">return</span></code> will do a calculation and send the result back at once, while when using <code class="docutils literal notranslate"><span class="pre">yield</span></code> a <strong>generator object</strong> is created and results can be returned sequentially.</p>
<p>Comparing the following two examples, the <code class="docutils literal notranslate"><span class="pre">return_list</span></code> function stores the complete list in the memory, while the <code class="docutils literal notranslate"><span class="pre">yield_list</span></code> function does not. Instead, it returns the values one after another (when using the <code class="docutils literal notranslate"><span class="pre">next()</span></code> function or a loop) remembering the current state of the function.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">return_list</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">)]</span>

<span class="k">def</span> <span class="nf">yield_list</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>    <span class="c1"># function mimics range()</span>
    <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">while</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">n</span><span class="p">:</span>
        <span class="k">yield</span> <span class="n">i</span>
        <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">return_list</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[0, 1, 2, 3, 4]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">yield_list</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>   <span class="c1"># creates a generator object</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;generator object yield_list at 0x7ff7202a2580&gt;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gen</span> <span class="o">=</span> <span class="n">yield_list</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>    <span class="c1"># assign generator object to variable</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="nb">next</span><span class="p">(</span><span class="n">gen</span><span class="p">))</span>    <span class="c1"># call next() to jump to next &#39;yield&#39;</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">next</span><span class="p">(</span><span class="n">gen</span><span class="p">))</span>    <span class="c1"># only one value in memory</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">next</span><span class="p">(</span><span class="n">gen</span><span class="p">))</span> <span class="c1"># another next() throws error because the generator is depleted after 4!</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0
1
2
</pre></div>
</div>
</div>
</div>
<p>Since the state of the generator is remembered and we have already moved beyond 2 using <code class="docutils literal notranslate"><span class="pre">next()</span></code>, the following for loop ‘finishes’ the generator:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">gen</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3
4
</pre></div>
</div>
</div>
</div>
<p>Generator object can be useful when working with huge files which do not fit into memory.</p>
<p>For functions with several arguments, the order of inputs is important. They will be read according to the function definition. When the arguments are specified in the function call, the input order does not matter.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">divide</span><span class="p">(</span><span class="n">numer</span><span class="p">,</span> <span class="n">denom</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">numer</span> <span class="o">/</span> <span class="n">denom</span>

<span class="nb">print</span><span class="p">(</span><span class="n">divide</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">divide</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>

<span class="nb">print</span><span class="p">(</span><span class="n">divide</span><span class="p">(</span><span class="n">denom</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">numer</span><span class="o">=</span><span class="mi">10</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>5.0
0.2
5.0
</pre></div>
</div>
</div>
</div>
<p>Default values for a function can be set. If an argument is not specified when calling the function, the default value will be used.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">divide</span><span class="p">(</span><span class="n">numer</span><span class="p">,</span> <span class="n">denom</span> <span class="o">=</span> <span class="mi">1</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">numer</span> <span class="o">/</span> <span class="n">denom</span>
<span class="nb">print</span><span class="p">(</span><span class="n">divide</span><span class="p">(</span><span class="n">numer</span><span class="o">=</span><span class="mi">10</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>10.0
</pre></div>
</div>
</div>
</div>
<p>More advanced function writing involves recursion, meaning python allows a function to call itself.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">math</span>

<span class="k">def</span> <span class="nf">my_factorial</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">1</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">n</span> <span class="o">*</span> <span class="n">my_factorial</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    
<span class="nb">print</span><span class="p">(</span><span class="n">my_factorial</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">factorial</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>120
120
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="global-and-local-variables">
<h3>Global and Local Variables<a class="headerlink" href="#global-and-local-variables" title="Permalink to this headline">¶</a></h3>
<p>Variables can be defined globally, i.e. outside of functions. A variable defined inside a function will only exist inside the scope of the function. Should a local variable be given the same name as a global variable, the function will use the value locally defined!<br />
Global variables inside functions can be defined using the <code class="docutils literal notranslate"><span class="pre">global</span></code> keyword before the respective variables.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="mi">7</span>
<span class="k">def</span> <span class="nf">f_1</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;calling f_1, x =&#39;</span><span class="p">,</span><span class="n">x</span><span class="p">)</span>

<span class="n">f_1</span><span class="p">()</span>
    
<span class="k">def</span> <span class="nf">f_2</span><span class="p">():</span>
    <span class="n">x</span> <span class="o">=</span> <span class="mi">10</span>

<span class="n">f_2</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;after calling f_2: x =&#39;</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
    
<span class="k">def</span> <span class="nf">f_3</span><span class="p">():</span>
    <span class="n">x</span> <span class="o">=</span> <span class="mi">10</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;calling f_3: x =&#39;</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
    
<span class="n">f_3</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;after calling f_3: x =&#39;</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
    
<span class="k">def</span> <span class="nf">f_4</span><span class="p">():</span>
    <span class="k">global</span> <span class="n">x</span>
    <span class="n">x</span> <span class="o">=</span> <span class="mi">10</span>

<span class="n">f_4</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;after calling f_4: x =&#39;</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>calling f_1, x = 7
after calling f_2: x = 7
calling f_3: x = 10
after calling f_3: x = 7
after calling f_4: x = 10
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="lambda-functions">
<h2>Lambda functions<a class="headerlink" href="#lambda-functions" title="Permalink to this headline">¶</a></h2>
<p>It might occur that a function is needed which is only needed once and has only a limited functionality. To spare you and the reader of the code from jumping to a block of defining such a function you can use a <strong>lambda function</strong>. They are written in-line by the keyword <code class="docutils literal notranslate"><span class="pre">lambda</span></code>, followed by the parameters and a colon before the body.<br />
Arguments are passed in parentheses as usual.</p>
<div class="admonition-note admonition">
<p class="admonition-title">Note</p>
<p>The lambda syntax should only be used for simple functions!</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">math</span> <span class="kn">import</span> <span class="n">exp</span>

<span class="c1"># regular way</span>
<span class="k">def</span> <span class="nf">reg_func</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="mi">1</span><span class="o">/</span><span class="n">exp</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">reg_func</span><span class="p">(</span><span class="mf">.5</span><span class="p">))</span>

<span class="c1">#lambda function with identifier </span>
<span class="n">l_func</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mi">1</span><span class="o">/</span><span class="n">exp</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>        <span class="c1"># this way, it is hard to find the origin of a function if it is called elsewhere</span>
<span class="nb">print</span><span class="p">(</span><span class="n">l_func</span><span class="p">(</span><span class="mf">.5</span><span class="p">))</span>                  <span class="c1"># in your code. It is not recommended, yet still possible.</span>

<span class="c1"># for single use, no identifier</span>
<span class="nb">print</span><span class="p">((</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mi">1</span><span class="o">/</span><span class="n">exp</span><span class="p">(</span><span class="n">x</span><span class="p">))(</span><span class="mf">.5</span><span class="p">)</span> <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.6065306597126334
0.6065306597126334
0.6065306597126334
</pre></div>
</div>
</div>
</div>
<p>Lambda functions can be easily applied in combination with list comprehension, where the can be defined in place.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># with list comprehension</span>
<span class="n">l_list</span> <span class="o">=</span> <span class="p">[(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mi">1</span><span class="o">/</span><span class="n">exp</span><span class="p">(</span><span class="n">x</span><span class="p">))(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">list_1</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">l_list</span><span class="p">)</span>

<span class="c1"># always consider doing it without a lambda function</span>
<span class="nb">print</span><span class="p">([(</span><span class="mi">1</span><span class="o">/</span><span class="n">exp</span><span class="p">(</span><span class="n">i</span><span class="p">))</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">list_1</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[1.0, 0.36787944117144233, 0.1353352832366127, 0.049787068367863944, 0.018315638888734182]
[1.0, 0.36787944117144233, 0.1353352832366127, 0.049787068367863944, 0.018315638888734182]
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="callbacks">
<h2>Callbacks<a class="headerlink" href="#callbacks" title="Permalink to this headline">¶</a></h2>
<p>A callback is a function, which is run as soon as some criterion is met, usually when some other task is finished to use this result in further computations. One example might be a file which needs to be imported and subsequently transformed in some way, but only as the import is complete. When defining callbacks, we make use of python’s property that anything is an object. So, here we pass a function as an argument to another function. The basic syntax when defining functions is the same as before.</p>
<p>The following is a basic example for a callback. The first function <code class="docutils literal notranslate"><span class="pre">enter_string</span></code> will print the string provided as argument. The string will then be handled depending on the callback: the length of the string will be printed or the string will be printed in reverse. The <code class="docutils literal notranslate"><span class="pre">if</span></code> clause in <code class="docutils literal notranslate"><span class="pre">enter_string</span></code> together with a default value of <code class="docutils literal notranslate"><span class="pre">None</span></code> allows us to omit a callback.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">enter_string</span><span class="p">(</span><span class="n">string</span><span class="p">,</span> <span class="n">callback</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">callback</span><span class="p">:</span>
        <span class="n">callback</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>
    
<span class="k">def</span> <span class="nf">print_len</span><span class="p">(</span><span class="n">string</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">string</span><span class="p">))</span>
    
<span class="k">def</span> <span class="nf">reverse_string</span><span class="p">(</span><span class="n">string</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">string</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
    
<span class="n">enter_string</span><span class="p">(</span><span class="s1">&#39;onomatopoeia&#39;</span><span class="p">,</span> <span class="n">callback</span><span class="o">=</span><span class="n">print_len</span><span class="p">)</span>

<span class="n">enter_string</span><span class="p">(</span><span class="s1">&#39;stressed&#39;</span><span class="p">,</span> <span class="n">callback</span><span class="o">=</span><span class="n">reverse_string</span><span class="p">)</span>

<span class="n">enter_string</span><span class="p">(</span><span class="s1">&#39;no callback here&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>onomatopoeia
12
stressed
desserts
no callback here
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="decorators">
<h2>Decorators<a class="headerlink" href="#decorators" title="Permalink to this headline">¶</a></h2>
<p>Functions which expand the functionality of another function are called decorators (or wrappers). However, these decorators do not change the underlying function, i.e. the one that <em>gets decorated</em>.</p>
<p>This is possible since functions, just like anything in python, are objects and can get passed as arguments to other functions (we have seen this in the context of callbacks). Furthermore, functions may be defined inside other functions, using the the same syntax as usual.</p>
<p>Let’s look at a simple example of a function and a wrapper/decorator.
The initial function <code class="docutils literal notranslate"><span class="pre">text_to_wrap</span></code> simply prints a string. The decorator returns the <code class="docutils literal notranslate"><span class="pre">wrapper()</span></code> function, which adds a line above and below the text, when printing.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">text_to_wrap</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;my text&#39;</span><span class="p">)</span>
    
<span class="n">text_to_wrap</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>my text
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">emphasize_decorator</span><span class="p">(</span><span class="n">func</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">wrapper</span><span class="p">():</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;##################&#39;</span><span class="p">)</span>
        <span class="n">func</span><span class="p">()</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;!!!!!!!!!!!!!!!!!!&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">wrapper</span>
</pre></div>
</div>
</div>
</div>
<p>To decorate <code class="docutils literal notranslate"><span class="pre">text_to_wrap</span></code>, we can assign the decorator with ‘<code class="docutils literal notranslate"><span class="pre">text_to_wrap</span></code>’ as argument to the initial function name. Note that we pass the function name without parentheses.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">text_to_wrap</span> <span class="o">=</span> <span class="n">emphasize_decorator</span><span class="p">(</span><span class="n">text_to_wrap</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">text_to_wrap</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>##################
my text
!!!!!!!!!!!!!!!!!!
</pre></div>
</div>
</div>
</div>
<p>To shorten this procedure, python includes a special syntax for decorators. With <code class="docutils literal notranslate"><span class="pre">&#64;emphasize_decorator</span></code> (no parentheses!) before the definition of the inner function, we can achieve the same behaviour.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># emphasize_decorator is being treated as already defined</span>

<span class="nd">@emphasize_decorator</span>
<span class="k">def</span> <span class="nf">print_greeting</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Hello&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">print_greeting</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>##################
Hello
!!!!!!!!!!!!!!!!!!
</pre></div>
</div>
</div>
</div>
<p>We see, that <code class="docutils literal notranslate"><span class="pre">print_greeting()</span></code> has initially been defined to print ‘Hello’. With the decorator call using <code class="docutils literal notranslate"><span class="pre">&#64;</span></code>, however, we have decorated it on the fly to add the emphasis lines around the text from <code class="docutils literal notranslate"><span class="pre">emphasize_decorator()</span></code>.</p>
<p>Furthermore, decorators may be chained by subsequent calls of the decorator functions with the same <code class="docutils literal notranslate"><span class="pre">&#64;</span></code>-syntax before the definition of the inner function. This example uses the same decorator twice, which is just a special case. Any decorators can be chained.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nd">@emphasize_decorator</span>
<span class="nd">@emphasize_decorator</span>
<span class="k">def</span> <span class="nf">print_greeting</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Hello&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>To pass arguments through the decorator, we can use <code class="docutils literal notranslate"><span class="pre">*args</span></code> and <code class="docutils literal notranslate"><span class="pre">**kwargs</span></code> as placeholder for an arbitrary number of positional arguments and keyword arguments. Note that this is not unique for decorators, but can be used for the definition of any function! We will now update the first two examples from above:
- <code class="docutils literal notranslate"><span class="pre">text_to_wrap</span></code> will get two arguments to print
- <code class="docutils literal notranslate"><span class="pre">wrapper</span></code> inside <code class="docutils literal notranslate"><span class="pre">emphasize_decorator</span></code> will get the placeholders in it’s definition</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">emphasize_decorator</span><span class="p">(</span><span class="n">func</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">wrapper</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;##################&#39;</span><span class="p">)</span>
        <span class="n">func</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;!!!!!!!!!!!!!!!!!!&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">wrapper</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nd">@emphasize_decorator</span>
<span class="k">def</span> <span class="nf">text_to_wrap</span><span class="p">(</span><span class="n">w1</span><span class="p">,</span> <span class="n">w2</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">w1</span><span class="si">}</span><span class="se">\n</span><span class="si">{</span><span class="n">w2</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">text_to_wrap</span><span class="p">(</span><span class="s1">&#39;line1&#39;</span><span class="p">,</span> <span class="s1">&#39;line2&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>##################
line1
line2
!!!!!!!!!!!!!!!!!!
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="classes">
<h2>Classes<a class="headerlink" href="#classes" title="Permalink to this headline">¶</a></h2>
<p>Since almost everything in python is an object, classes are a very important element to its functionality. A class can be seen as a constructor for certain objects. \</p>
<p>To define a class, the <code class="docutils literal notranslate"><span class="pre">class</span></code> keyword is followed by the class name. By convention, for class names the CamelCase style is used.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># define class Student</span>

<span class="k">class</span> <span class="nc">Student</span><span class="p">:</span>
    <span class="n">uni</span> <span class="o">=</span> <span class="s1">&#39;Passau&#39;</span>
    <span class="n">subject</span> <span class="o">=</span> <span class="s1">&#39;math&#39;</span>
    <span class="n">grades</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.3</span><span class="p">,</span> <span class="mf">1.7</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">]</span>
        
<span class="c1"># instantiate object  </span>
<span class="n">Chris</span> <span class="o">=</span> <span class="n">Student</span>
<span class="n">Tina</span> <span class="o">=</span> <span class="n">Student</span>

<span class="c1"># get uni of student Chris</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Uni:&#39;</span><span class="p">,</span> <span class="n">Chris</span><span class="o">.</span><span class="n">uni</span><span class="p">)</span>

<span class="c1"># student changes subject</span>
<span class="n">Chris</span><span class="o">.</span><span class="n">subject</span> <span class="o">=</span> <span class="s1">&#39;biology&#39;</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Chris&#39; subject:&quot;</span><span class="p">,</span> <span class="n">Chris</span><span class="o">.</span><span class="n">subject</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;class name:&#39;</span><span class="p">,</span> <span class="n">Chris</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Tina&#39;s subject:&quot;</span><span class="p">,</span> <span class="n">Tina</span><span class="o">.</span><span class="n">subject</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Uni: Passau
Chris&#39; subject: biology
class name: Student
Tina&#39;s subject: biology
</pre></div>
</div>
</div>
</div>
<p>Classes can not only store values but also functions, called methods. Methods are defined just like regular functions, but inside the class body. To make a class more useful (compared to the example above), the <code class="docutils literal notranslate"><span class="pre">__init__()</span></code> method is needed. As arguments, it takes <code class="docutils literal notranslate"><span class="pre">self</span></code> and all other arguments needed as input to build the object. <code class="docutils literal notranslate"><span class="pre">self</span></code> is used for instance variables, i.e. variables that belong to an object and not the whole class.</p>
<p>Methods and class variables are chained by a <code class="docutils literal notranslate"><span class="pre">.</span></code> to the object.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Student</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">uni</span><span class="p">,</span> <span class="n">subject</span><span class="p">,</span> <span class="n">grades</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">uni</span> <span class="o">=</span> <span class="n">uni</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">subject</span> <span class="o">=</span> <span class="n">subject</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">grades</span> <span class="o">=</span> <span class="n">grades</span>
    
    <span class="c1">#define method to show average grade</span>
    <span class="k">def</span> <span class="nf">avg_grade</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">grades</span><span class="p">)</span>
     
<span class="n">Chris</span> <span class="o">=</span> <span class="n">Student</span><span class="p">(</span><span class="s1">&#39;Passau&#39;</span><span class="p">,</span> <span class="s1">&#39;Art&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mf">1.3</span><span class="p">,</span> <span class="mf">1.7</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">])</span>
<span class="n">Tina</span> <span class="o">=</span> <span class="n">Student</span><span class="p">(</span><span class="s1">&#39;Regensburg&#39;</span><span class="p">,</span> <span class="s1">&#39;Physics&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">])</span>

<span class="n">Chris</span><span class="o">.</span><span class="n">subject</span> <span class="o">=</span> <span class="s1">&#39;engineering&#39;</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Chris: </span><span class="si">{</span><span class="n">Chris</span><span class="o">.</span><span class="n">subject</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Tina: </span><span class="si">{</span><span class="n">Tina</span><span class="o">.</span><span class="n">subject</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">Chris</span><span class="o">.</span><span class="n">avg_grade</span><span class="p">())</span>

<span class="c1"># lists have a built-in method append, which adds items given as arguments to the end of the list (see help(list))</span>
<span class="n">Chris</span><span class="o">.</span><span class="n">grades</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mf">5.0</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">Chris</span><span class="o">.</span><span class="n">avg_grade</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Chris: engineering
Tina: Physics
2.0
2.75
</pre></div>
</div>
</div>
</div>
<div class="section" id="inheritance">
<h3>Inheritance<a class="headerlink" href="#inheritance" title="Permalink to this headline">¶</a></h3>
<p>Classes can inherit all properties from other classes by using the <code class="docutils literal notranslate"><span class="pre">super()</span></code> function in the constructor. This should be applied, if a new class should expand the functionality of the original class without wanting to change the original class. For example if a Student is also a resident:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">LocalResident</span><span class="p">(</span><span class="n">Student</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">uni</span><span class="p">,</span> <span class="n">subject</span><span class="p">,</span> <span class="n">grades</span><span class="p">,</span> <span class="n">address</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">uni</span><span class="p">,</span> <span class="n">subject</span><span class="p">,</span> <span class="n">grades</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">address</span> <span class="o">=</span> <span class="n">address</span>
        
<span class="n">Chris</span> <span class="o">=</span> <span class="n">LocalResident</span><span class="p">(</span><span class="s1">&#39;Passau&#39;</span><span class="p">,</span> <span class="s1">&#39;Art&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mf">1.3</span><span class="p">,</span> <span class="mf">1.7</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">,</span> <span class="mf">5.0</span><span class="p">],</span> <span class="s1">&#39;Innstr. 27&#39;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot; Uni and address: </span><span class="si">{</span><span class="n">Chris</span><span class="o">.</span><span class="n">uni</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">Chris</span><span class="o">.</span><span class="n">address</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">Chris</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> Uni and address: Passau, Innstr. 27
&lt;class &#39;__main__.LocalResident&#39;&gt;
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="files">
<h2>Files<a class="headerlink" href="#files" title="Permalink to this headline">¶</a></h2>
<p>Regular python files end with <em>.py</em> and code can be written and read in any text editor. Only the suffix will tell the interpreter how to handle the file, in this case as a python script.</p>
<p>Jupyter Notebook files end with <em>.ipynb</em>. The special cell-wise structure leads to more formatting effort which is stored in a .json format (see later chapters), meaning that when a <em>.ipynb</em> file is opened in an ordinary text editor, the structure will be very different from what is shown in this jupyter interface.</p>
<p>Below a jupyter notebook is shown on the left. The formatting is seen on the right, where the <em>.ipynb</em> file was opened using a text editor.</p>
<p><img alt="" src="_images/struc.png" /></p>
</div>
</div>
<div class="section" id="second-steps">
<h1>Second steps<a class="headerlink" href="#second-steps" title="Permalink to this headline">¶</a></h1>
<p>In the following, some common operations are shown in order to get used to the python language und its functionality.</p>
<div class="section" id="numpy">
<h2>NumPy<a class="headerlink" href="#numpy" title="Permalink to this headline">¶</a></h2>
<p>One of the most useful and widely used libraries is <strong>NumPy</strong>. It makes working with arrays, and thus vectors and matrices, very efficient and includes a broad variety of mathematical tools. Because of its powerful implementations, it serves many other packages as a basis.</p>
<p>Even though this course will hardly rely on numpy itself, a short introduction is given in the following.</p>
<p>We will start with importing as <strong>np</strong>. Information will mainly be given by comments in the code.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="c1"># mathematical functions:</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;sin(pi) = &#39;</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">))</span> 
<span class="c1"># note that the sine of the number pi is defined as zero, yet python returns a small number &gt; 0</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>sin(pi) =  1.2246467991473532e-16
</pre></div>
</div>
</div>
</div>
<p>One of the most useful concepts is that of <em>arrays</em>, which can have an arbitrary number of dimensions (yet three should do here). Arrays correspond mainly to what you should know as scalar, vector or matrix.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">arr_a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span>
<span class="n">arr_b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>

<span class="c1">#dimensions of an array</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;0. dimension of array a&#39;</span><span class="p">,</span> <span class="n">arr_a</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>

<span class="c1"># operations can be performed by methods and methods chaining on these array objects</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;1. sum of array a:&#39;</span><span class="p">,</span><span class="n">arr_a</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;2. variance of array a:&#39;</span><span class="p">,</span> <span class="n">arr_a</span><span class="o">.</span><span class="n">var</span><span class="p">())</span>

<span class="c1"># broadcasting a scalar to an array</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;3. one plus array b:&#39;</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">arr_b</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;4. element-wise multiplication of arrays:&#39;</span><span class="p">,</span> <span class="n">arr_a</span> <span class="o">*</span> <span class="n">arr_b</span><span class="p">)</span>

<span class="c1"># vector multiplication / dot product</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;5. scalar by dot product:&#39;</span><span class="p">,</span> <span class="n">arr_a</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">arr_b</span><span class="p">))</span>   <span class="c1"># this should not yield a scalar for vectors!</span>

<span class="c1"># for real vectors, the inner dimension of the product is crucial -&gt; (5x5)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;5.1 vector multiplication: </span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">matrix</span><span class="p">(</span><span class="n">arr_a</span><span class="p">)</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">matrix</span><span class="p">(</span><span class="n">arr_b</span><span class="p">)))</span>

<span class="c1"># shapes differ for arrays and matrices</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;5.2 transposed array:&#39;</span><span class="p">,</span> <span class="n">arr_a</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="s1">&#39;transposed matrix:&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">matrix</span><span class="p">(</span><span class="n">arr_a</span><span class="p">)</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span><span class="o">.</span><span class="n">shape</span> <span class="p">)</span>

<span class="c1"># to reshape an array, use the reshape method</span>
<span class="n">zero_arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;6. array:     reshaped:           same result:</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> 
      <span class="n">zero_arr</span><span class="p">,</span> <span class="n">zero_arr</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,),</span> <span class="n">zero_arr</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">6</span><span class="p">,))</span>  
<span class="c1"># -1 is for &quot;unknown&quot; dim (like a wildcard)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0. dimension of array a (5,)
1. sum of array a: 15
2. variance of array a: 2.0
3. one plus array b: [1 1 1 1 2]
4. element-wise multiplication of arrays: [0 0 0 0 5]
5. scalar by dot product: 5
5.1 vector multiplication: 
 [[0 0 0 0 1]
 [0 0 0 0 2]
 [0 0 0 0 3]
 [0 0 0 0 4]
 [0 0 0 0 5]]
5.2 transposed array: (5,) transposed matrix: (5, 1)
6. array:     reshaped:           same result:
 [[0. 0. 0.]
 [0. 0. 0.]] [0. 0. 0. 0. 0. 0.] [0. 0. 0. 0. 0. 0.]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># random number generation with np.random module</span>

<span class="c1"># for a list of probability distributions, the autocomplete function can be used (press tab after the dot)</span>
<span class="n">random_expo</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">exponential</span><span class="p">(</span><span class="n">scale</span><span class="o">=</span><span class="mf">.5</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">random_expo</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[0.74006526 0.47728165 0.13880161 0.46641192 0.21374492]
 [0.32845367 0.85378176 1.17746819 0.62523159 0.12982107]
 [0.40776216 0.05552487 0.48478477 0.87712197 0.86442858]
 [0.33747599 0.78235291 0.28141233 0.78810345 0.64114476]
 [0.636935   0.44496018 0.03349161 1.1576968  1.52609472]]
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="working-with-data">
<h1>Working with Data<a class="headerlink" href="#working-with-data" title="Permalink to this headline">¶</a></h1>
<p>Several libraries offer useful tools to work with data in order to allow for a meaningful analysis. One of the most popular and powerful is <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/index.html"><strong>Pandas</strong></a>. Beside including efficient ways for cleaning and manipulating data, pandas also includes functions for statistical analysis and graphics.</p>
<p>Usually, pandas is imported under the alias <code class="docutils literal notranslate"><span class="pre">pd</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="pandas-dataframes-and-series">
<h2>Pandas - DataFrames and Series<a class="headerlink" href="#pandas-dataframes-and-series" title="Permalink to this headline">¶</a></h2>
<div class="section" id="indexing">
<h3>Indexing<a class="headerlink" href="#indexing" title="Permalink to this headline">¶</a></h3>
<p>The basic elements for data are <em>DataFrames</em> and <em>Series</em>. A DataFrame is a whole matrix- or table-like representation of data with column and row names. A Series can be understood as a single column of such a data matrix (but without the need for a table).<br />
There are respective functions to turn other objects, e.g. lists or dicts, into DataFrames or Series. Indexing, similar to lists or dicts, uses square brackets.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">my_list</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">]</span>
<span class="n">my_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">my_list</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;var1&#39;</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;df:</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">my_df</span><span class="p">)</span>

<span class="n">my_series</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">my_list</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;series:</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span><span class="n">my_series</span><span class="p">)</span>

<span class="c1"># selecting a single column from a DataFrame</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;select column from df:</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">my_df</span><span class="p">[</span><span class="s1">&#39;var1&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>df:
 
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   var1
0     1
1     2
2     3
3     4
4     5
5     6
6     7
series:
 0    1
1    2
2    3
3    4
4    5
5    6
6    7
dtype: int64
select column from df:
 0    1
1    2
2    3
3    4
4    5
5    6
6    7
Name: var1, dtype: int64
</pre></div>
</div>
</div>
</div>
<p>To select specific rows or columns, the <code class="docutils literal notranslate"><span class="pre">iloc</span></code> method, for selecting based on an index, and <code class="docutils literal notranslate"><span class="pre">loc</span></code> method, based on labels, are recommended. Especially when several columns are to be selected. Indexing can also be done by boolean Series (or lists) and thus conditionally. <br />
Another way to select a single column is by chaining the column’s name to the DataFrame’s name by a dot (like in method chaining).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">my_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<span class="p">{</span><span class="s1">&#39;age&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">20</span><span class="p">,</span> <span class="mi">34</span><span class="p">,</span> <span class="mi">56</span><span class="p">],</span>
 <span class="s1">&#39;height&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">183</span><span class="p">,</span> <span class="mi">179</span><span class="p">,</span> <span class="mi">172</span><span class="p">]</span>
<span class="p">},</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;person_a&#39;</span><span class="p">,</span> <span class="s1">&#39;person_b&#39;</span><span class="p">,</span> <span class="s1">&#39;person_c&#39;</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">my_df</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;1.:&#39;</span><span class="p">,</span> <span class="n">my_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;person_b&#39;</span><span class="p">,</span><span class="s1">&#39;age&#39;</span><span class="p">],</span> <span class="s1">&#39;is the same as&#39;</span><span class="p">,</span>  <span class="n">my_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>

<span class="c1"># age &gt; 27</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;indexing by condition/list</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">my_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">my_df</span><span class="o">.</span><span class="n">age</span> <span class="o">&gt;</span><span class="mi">27</span><span class="p">],</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">corresponds to </span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">my_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[[</span><span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">]])</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">my_df</span><span class="o">.</span><span class="n">age</span> <span class="o">&gt;</span><span class="mi">27</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>          age  height
person_a   20     183
person_b   34     179
person_c   56     172
1.: 34 is the same as 34
indexing by condition/list
           age  height
person_b   34     179
person_c   56     172 
corresponds to 
           age  height
person_b   34     179
person_c   56     172
&lt;class &#39;pandas.core.series.Series&#39;&gt;
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="useful-methods">
<h3>Useful Methods<a class="headerlink" href="#useful-methods" title="Permalink to this headline">¶</a></h3>
<p>Pandas includes many useful methods that will help you get to know and manipulate a dataset. Some of these methods are shown in the following, others are introduced later when needed.<br />
More often than not, a dataset will contain missing values, i.e. cells in a data table contain no value. They will be depicted as <code class="docutils literal notranslate"><span class="pre">NaN</span></code>, <strong>N</strong>ot <strong>a</strong> <strong>N</strong>umber.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="n">my_df</span> <span class="o">=</span>  <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<span class="p">{</span><span class="s1">&#39;age&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">20</span><span class="p">,</span> <span class="mi">34</span><span class="p">,</span> <span class="mi">56</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mi">44</span><span class="p">],</span>
 <span class="s1">&#39;height&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">183</span><span class="p">,</span> <span class="mi">179</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span>  <span class="mi">163</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">]</span>
<span class="p">})</span>
<span class="n">my_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>age</th>
      <th>height</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>20.0</td>
      <td>183.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>34.0</td>
      <td>179.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>56.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>NaN</td>
      <td>163.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>44.0</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># view the first rows (view last rows with .tail())</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;0.</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">my_df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">5</span><span class="p">))</span>


<span class="c1"># general information</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">1.&#39;</span><span class="p">)</span>
<span class="n">my_df</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>

<span class="c1"># descriptive statistics on dataset</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">2.</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span><span class="n">my_df</span><span class="o">.</span><span class="n">describe</span><span class="p">())</span>

<span class="c1"># number of missing values per column</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">3.</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span><span class="n">my_df</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>

<span class="c1"># single statistics are included as methods, also for single columns</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">4.</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">my_df</span><span class="o">.</span><span class="n">age</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>

<span class="c1"># fill missing values (e.g. with mean of column)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1"> 5.</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">my_df</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">my_df</span><span class="o">.</span><span class="n">mean</span><span class="p">()))</span>    

<span class="c1"># note that you must assign this to my_df (or a different variable) in order to impute missing values permanently!</span>
<span class="n">my_df</span> <span class="o">=</span> <span class="n">my_df</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">my_df</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>

<span class="c1"># sort values by column(s)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">6.</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">my_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;height&#39;</span><span class="p">]))</span>    
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.
     age  height
0  20.0   183.0
1  34.0   179.0
2  56.0     NaN
3   NaN   163.0
4  44.0     NaN

1.
&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 5 entries, 0 to 4
Data columns (total 2 columns):
 #   Column  Non-Null Count  Dtype  
---  ------  --------------  -----  
 0   age     4 non-null      float64
 1   height  3 non-null      float64
dtypes: float64(2)
memory usage: 208.0 bytes

2.
              age      height
count   4.000000    3.000000
mean   38.500000  175.000000
std    15.264338   10.583005
min    20.000000  163.000000
25%    30.500000  171.000000
50%    39.000000  179.000000
75%    47.000000  181.000000
max    56.000000  183.000000

3.
 age       1
height    2
dtype: int64

4.
 38.5

 5.
     age  height
0  20.0   183.0
1  34.0   179.0
2  56.0   175.0
3  38.5   163.0
4  44.0   175.0

6.
     age  height
3  38.5   163.0
2  56.0   175.0
4  44.0   175.0
1  34.0   179.0
0  20.0   183.0
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># get column names (useful for looping)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;7.</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">my_df</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>

<span class="c1"># drop rows containing missing values</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;8.</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">my_df</span><span class="o">.</span><span class="n">dropna</span><span class="p">())</span> 

<span class="c1"># drop rows or columns</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;9.</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">my_df</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">&#39;age&#39;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>

<span class="c1"># merge DataFrames (automatically on shared variable if not specified otherwise)</span>
<span class="n">df2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<span class="p">{</span><span class="s1">&#39;age&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">20</span><span class="p">,</span> <span class="mi">34</span><span class="p">,</span> <span class="mi">56</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mi">44</span><span class="p">],</span>
 <span class="s1">&#39;weight&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">83</span><span class="p">,</span> <span class="mi">63</span><span class="p">,</span> <span class="mi">98</span><span class="p">,</span>  <span class="mi">50</span><span class="p">,</span> <span class="mi">77</span><span class="p">]</span>
<span class="p">})</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;10.</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">my_df</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df2</span><span class="p">))</span>
<span class="n">my_df</span> <span class="o">=</span> <span class="n">my_df</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df2</span><span class="p">)</span>

<span class="c1"># correlation matrix</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;11.</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">my_df</span><span class="o">.</span><span class="n">corr</span><span class="p">())</span>

<span class="c1"># adding new columns</span>
<span class="n">my_df</span> <span class="o">=</span> <span class="n">my_df</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">bmi</span> <span class="o">=</span> <span class="n">my_df</span><span class="o">.</span><span class="n">weight</span><span class="o">/</span><span class="p">(</span><span class="n">my_df</span><span class="o">.</span><span class="n">height</span><span class="o">/</span><span class="mi">100</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="n">my_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>7.
 Index([&#39;age&#39;, &#39;height&#39;], dtype=&#39;object&#39;)
8.
     age  height
0  20.0   183.0
1  34.0   179.0
2  56.0   175.0
3  38.5   163.0
4  44.0   175.0
9.
    height
0   183.0
1   179.0
2   175.0
3   163.0
4   175.0
10.
     age  height  weight
0  20.0   183.0      83
1  34.0   179.0      63
2  56.0   175.0      98
3  44.0   175.0      77
11.
              age    height    weight
age     1.000000 -0.946549  0.481176
height -0.946549  1.000000 -0.282126
weight  0.481176 -0.282126  1.000000
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>age</th>
      <th>height</th>
      <th>weight</th>
      <th>bmi</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>20.0</td>
      <td>183.0</td>
      <td>83</td>
      <td>24.784258</td>
    </tr>
    <tr>
      <th>1</th>
      <td>34.0</td>
      <td>179.0</td>
      <td>63</td>
      <td>19.662308</td>
    </tr>
    <tr>
      <th>2</th>
      <td>56.0</td>
      <td>175.0</td>
      <td>98</td>
      <td>32.000000</td>
    </tr>
    <tr>
      <th>3</th>
      <td>44.0</td>
      <td>175.0</td>
      <td>77</td>
      <td>25.142857</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>As a last tool in this section, we will look at the <code class="docutils literal notranslate"><span class="pre">get_dummies()</span></code> function. Dummy variables are used to encode categorical variables with zero and one, for example in order to calculate the correlation with some other numerical variable.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df3</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<span class="p">{</span><span class="s1">&#39;hair&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;blonde&#39;</span><span class="p">,</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="s1">&#39;black&#39;</span><span class="p">]</span>
<span class="p">})</span>

<span class="nb">print</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">get_dummies</span><span class="p">(</span><span class="n">df3</span><span class="o">.</span><span class="n">hair</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   black  blonde  red
0      0       1    0
1      1       0    0
2      0       0    1
3      0       0    1
4      1       0    0
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="plots">
<h3>Plots<a class="headerlink" href="#plots" title="Permalink to this headline">¶</a></h3>
<p>Methods for standard pot types are available. For a histogram of the data, just use <code class="docutils literal notranslate"><span class="pre">.hist()</span></code>. Other types are available by chaining <code class="docutils literal notranslate"><span class="pre">.plot.</span></code> and the plot type.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># histogram</span>
<span class="n">my_df</span><span class="o">.</span><span class="n">hist</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[&lt;AxesSubplot:title={&#39;center&#39;:&#39;age&#39;}&gt;,
        &lt;AxesSubplot:title={&#39;center&#39;:&#39;height&#39;}&gt;],
       [&lt;AxesSubplot:title={&#39;center&#39;:&#39;weight&#39;}&gt;,
        &lt;AxesSubplot:title={&#39;center&#39;:&#39;bmi&#39;}&gt;]], dtype=object)
</pre></div>
</div>
<img alt="_images/Python_introduction_126_1.png" src="_images/Python_introduction_126_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># lineplot</span>
<span class="n">my_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s1">&#39;age&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">line</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;age&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;height&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;AxesSubplot:xlabel=&#39;age&#39;&gt;
</pre></div>
</div>
<img alt="_images/Python_introduction_127_1.png" src="_images/Python_introduction_127_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># scatter plot</span>
<span class="n">my_df</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;age&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;weight&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;AxesSubplot:xlabel=&#39;age&#39;, ylabel=&#39;weight&#39;&gt;
</pre></div>
</div>
<img alt="_images/Python_introduction_128_1.png" src="_images/Python_introduction_128_1.png" />
</div>
</div>
</div>
<div class="section" id="importing-and-exporting-data">
<h3>Importing and Exporting Data<a class="headerlink" href="#importing-and-exporting-data" title="Permalink to this headline">¶</a></h3>
<p>Your data may come to you in various file formats. Pandas enables you to import data from all common formats. The respective functions are usually called <code class="docutils literal notranslate"><span class="pre">read_</span></code> and <code class="docutils literal notranslate"><span class="pre">to_</span></code> followed by the respective file type.</p>
<p>To read a <em>.csv</em> for example, use the <code class="docutils literal notranslate"><span class="pre">read_csv()</span></code> function. Note that the file must not be stored locally on your computer.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># import from csv</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="n">dax</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;data/DAX.csv&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">dax</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">dax</span><span class="o">.</span><span class="n">tail</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>         Date          Open          High           Low         Close  \
0  2020-03-10  10724.980469  11032.290039  10423.900391  10475.490234   
1  2020-03-11  10601.849609  10761.429688  10390.509766  10438.679688   
2  2020-03-12   9863.990234   9932.559570   9139.120117   9161.129883   

      Adj Close     Volume  
0  10475.490234  267400800  
1  10438.679688  216708900  
2   9161.129883  390477000  
           Date          Open          High           Low         Close  \
251  2021-03-08  14024.570313  14402.919922  13977.129883  14380.910156   
252  2021-03-09  14345.509766  14475.650391  14309.349609  14437.940430   
253  2021-03-10  14439.450195  14554.490234  14408.519531  14528.570313   

        Adj Close     Volume  
251  14380.910156  109071900  
252  14437.940430  107881800  
253  14528.570313          0  
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># save data frame to excel</span>
<span class="n">dax</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="s1">&#39;data/DAX.xlsx&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Lets do some exploration and manipulation of the historical data from the DAX index we just imported.
$ $</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;shape:&#39;</span><span class="p">,</span> <span class="n">dax</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>shape: (254, 7)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dax</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>    <span class="c1"># the &#39;Date&#39; column is of dtype object </span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 254 entries, 0 to 253
Data columns (total 7 columns):
 #   Column     Non-Null Count  Dtype  
---  ------     --------------  -----  
 0   Date       254 non-null    object 
 1   Open       254 non-null    float64
 2   High       254 non-null    float64
 3   Low        254 non-null    float64
 4   Close      254 non-null    float64
 5   Adj Close  254 non-null    float64
 6   Volume     254 non-null    int64  
dtypes: float64(5), int64(1), object(1)
memory usage: 14.0+ KB
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># check type of first entry in &#39;Date&#39;</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">dax</span><span class="o">.</span><span class="n">Date</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;str&#39;&gt;
</pre></div>
</div>
</div>
</div>
<p>Transform it to <em>datetime</em>, a special type for dates in python.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dax</span><span class="p">[</span><span class="s1">&#39;Datetime&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">dax</span><span class="o">.</span><span class="n">Date</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">dax</span><span class="o">.</span><span class="n">Datetime</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>    <span class="c1"># check dtype now</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0   2020-03-10
1   2020-03-11
2   2020-03-12
Name: Datetime, dtype: datetime64[ns]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">dax</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Index([&#39;Date&#39;, &#39;Open&#39;, &#39;High&#39;, &#39;Low&#39;, &#39;Close&#39;, &#39;Adj Close&#39;, &#39;Volume&#39;,
       &#39;Datetime&#39;],
      dtype=&#39;object&#39;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;of </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">dax</span><span class="p">)</span><span class="si">}</span><span class="s1"> rows:</span><span class="se">\n</span><span class="si">{</span><span class="n">dax</span><span class="o">.</span><span class="n">notna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;makes a total of </span><span class="si">{</span><span class="n">dax</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="si">}</span><span class="s1"> missing values&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>of 254 rows:
Date         254
Open         254
High         254
Low          254
Close        254
Adj Close    254
Volume       254
Datetime     254
dtype: int64

makes a total of 0 missing values
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;Datetime&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Open&#39;</span><span class="p">,</span> <span class="s1">&#39;Close&#39;</span><span class="p">])</span>    <span class="c1"># using Datetime for plotting</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;AxesSubplot:xlabel=&#39;Datetime&#39;&gt;
</pre></div>
</div>
<img alt="_images/Python_introduction_142_1.png" src="_images/Python_introduction_142_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dax</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Open</th>
      <th>High</th>
      <th>Low</th>
      <th>Close</th>
      <th>Adj Close</th>
      <th>Volume</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>254.000000</td>
      <td>254.000000</td>
      <td>254.000000</td>
      <td>254.000000</td>
      <td>254.000000</td>
      <td>2.540000e+02</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>12488.785944</td>
      <td>12595.082573</td>
      <td>12373.931187</td>
      <td>12489.142640</td>
      <td>12489.142640</td>
      <td>9.469272e+07</td>
    </tr>
    <tr>
      <th>std</th>
      <td>1324.154858</td>
      <td>1295.824891</td>
      <td>1365.892066</td>
      <td>1331.191733</td>
      <td>1331.191733</td>
      <td>4.941752e+07</td>
    </tr>
    <tr>
      <th>min</th>
      <td>8495.940430</td>
      <td>8668.480469</td>
      <td>8255.650391</td>
      <td>8441.709961</td>
      <td>8441.709961</td>
      <td>0.000000e+00</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>11896.257813</td>
      <td>12185.372315</td>
      <td>11850.512451</td>
      <td>12031.852783</td>
      <td>12031.852783</td>
      <td>6.409985e+07</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>12847.964844</td>
      <td>12945.129883</td>
      <td>12764.479981</td>
      <td>12851.169922</td>
      <td>12851.169922</td>
      <td>7.875350e+07</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>13314.162353</td>
      <td>13362.944824</td>
      <td>13224.792481</td>
      <td>13292.120361</td>
      <td>13292.120361</td>
      <td>1.085247e+08</td>
    </tr>
    <tr>
      <th>max</th>
      <td>14439.450195</td>
      <td>14554.490234</td>
      <td>14408.519531</td>
      <td>14528.570313</td>
      <td>14528.570313</td>
      <td>3.904770e+08</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>For statistics on one variable, index the result as usual.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mean_open</span> <span class="o">=</span> <span class="n">dax</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;mean&#39;</span><span class="p">,</span> <span class="s1">&#39;Open&#39;</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">mean_open</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>12488.785944444882
</pre></div>
</div>
</div>
</div>
<p>Create a new column, with a flag if the closing price was higher than the opening price.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dax</span> <span class="o">=</span> <span class="n">dax</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">positive</span> <span class="o">=</span> <span class="n">dax</span><span class="o">.</span><span class="n">Close</span> <span class="o">&gt;</span> <span class="n">dax</span><span class="o">.</span><span class="n">Open</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">dax</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="c1"># fraction of days when this was the case</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;fraction of positive days:&#39;</span><span class="p">,</span> <span class="n">dax</span><span class="o">.</span><span class="n">positive</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">check: </span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">dax</span><span class="o">.</span><span class="n">positive</span><span class="o">.</span><span class="n">value_counts</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>         Date          Open          High           Low         Close  \
0  2020-03-10  10724.980469  11032.290039  10423.900391  10475.490234   
1  2020-03-11  10601.849609  10761.429688  10390.509766  10438.679688   
2  2020-03-12   9863.990234   9932.559570   9139.120117   9161.129883   

      Adj Close     Volume   Datetime  positive  
0  10475.490234  267400800 2020-03-10     False  
1  10438.679688  216708900 2020-03-11     False  
2   9161.129883  390477000 2020-03-12     False  

fraction of positive days: 0.5

check: 
 False    127
True     127
Name: positive, dtype: int64
</pre></div>
</div>
</div>
</div>
<p>Extract same fraction for every day in the week. Days are counted from 0 (Monday) to 6 (Sunday).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">7</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;day </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">: &#39;</span><span class="p">,</span> <span class="n">dax</span><span class="p">[</span><span class="n">dax</span><span class="o">.</span><span class="n">Datetime</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">dayofweek</span> <span class="o">==</span> <span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">positive</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>day 0:  0.58
day 1:  0.49056603773584906
day 2:  0.5283018867924528
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>day 3:  0.44
day 4:  0.4583333333333333
day 5:  nan
day 6:  
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>nan
</pre></div>
</div>
</div>
</div>
<p>A more straight forward way using built-in methods.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dax</span> <span class="o">=</span> <span class="n">dax</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">wday</span> <span class="o">=</span> <span class="n">dax</span><span class="o">.</span><span class="n">Datetime</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">dayofweek</span><span class="p">)</span>
<span class="n">dax</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;wday&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>  <span class="c1"># rows with nans are not calculated</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Open</th>
      <th>High</th>
      <th>Low</th>
      <th>Close</th>
      <th>Adj Close</th>
      <th>Volume</th>
      <th>positive</th>
    </tr>
    <tr>
      <th>wday</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>12510.387852</td>
      <td>12640.970996</td>
      <td>12400.179629</td>
      <td>12546.658457</td>
      <td>12546.658457</td>
      <td>8.860451e+07</td>
      <td>0.580000</td>
    </tr>
    <tr>
      <th>1</th>
      <td>12523.045843</td>
      <td>12621.270969</td>
      <td>12403.764906</td>
      <td>12520.457547</td>
      <td>12520.457547</td>
      <td>9.450496e+07</td>
      <td>0.490566</td>
    </tr>
    <tr>
      <th>2</th>
      <td>12522.144310</td>
      <td>12628.387014</td>
      <td>12414.166403</td>
      <td>12527.621886</td>
      <td>12527.621886</td>
      <td>9.062774e+07</td>
      <td>0.528302</td>
    </tr>
    <tr>
      <th>3</th>
      <td>12422.626602</td>
      <td>12512.666523</td>
      <td>12286.600566</td>
      <td>12394.369766</td>
      <td>12394.369766</td>
      <td>9.770017e+07</td>
      <td>0.440000</td>
    </tr>
    <tr>
      <th>4</th>
      <td>12460.538106</td>
      <td>12567.442179</td>
      <td>12360.190674</td>
      <td>12450.887695</td>
      <td>12450.887695</td>
      <td>1.025976e+08</td>
      <td>0.458333</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
</div>
</div>
<div class="section" id="scikit-learn">
<h1>SciKit Learn<a class="headerlink" href="#scikit-learn" title="Permalink to this headline">¶</a></h1>
<p>The <a class="reference external" href="https://scikit-learn.org/stable/">sklearn package</a> provides a broad collection of data analysis and machine learning tools. These tools basically cover the whole process from data manipulation over fitting different models to the data and evaluating the results. Sklearn is based on <strong>numpy</strong> and may thus require that the data to analyse is provided as an numpy array. Results will also be returned as such arrays.</p>
<p>The respective modules, i.e. classes and functions of different algorithms, are provided in an API which allows easy application basically without requiring knowledge about how the algorithm itself works. It goes without mentioning, that you should have some basic understanding about the particular strengths of an algorithm and any caveats when fitting a model to extract meaningful results.</p>
<p>In this course, we will present only a small portion of sklearn’s functionality and refer to the <a class="reference external" href="https://scikit-learn.org/stable/modules/classes.html">API’s documentation</a>.</p>
<p>Sklearn provides a kind of framework syntax for fitting models of different kinds:</p>
<ul class="simple">
<li><p>instantiate the respective (algorithm’s) object. Here, the hyper parameters and options are set</p></li>
<li><p>fit the data using this object</p></li>
<li><p>evaluate the model or use the model for prediction</p></li>
</ul>
<p>We will now look at some basic procedures for analysing data using different methods.</p>
<p>To load our modules, we import them specifically from the <code class="docutils literal notranslate"><span class="pre">skikit-learn</span></code> (name for installation) package instead of importing the whole package.</p>
<div class="section" id="data-manipulation">
<h2>Data manipulation<a class="headerlink" href="#data-manipulation" title="Permalink to this headline">¶</a></h2>
<p>When working with real data, the scale of your variables may differ dramatically. However, some algorithms work numerically more stable when the feature values are set in the same range. Some types of regression for example even require rescaling in order to work properly.</p>
<p>Sklearn provides several scaler classes to map all values to a desired range. Note however, that such rescaling may affect the interpretation of the results.</p>
<p>Let’s have a look at the <code class="docutils literal notranslate"><span class="pre">StandardScaler</span></code> which is part of the <code class="docutils literal notranslate"><span class="pre">Preprocessing</span></code> module.
It assumes a normal distribution of features. The rescaling is done by subtracting the mean and dividing by the standard deviation.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">StandardScaler</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</pre></div>
</div>
</div>
</div>
<p>In the example below, we create an array filled with 1000 numbers drawn from a normal distribution with 2 two and standard deviation of 5.</p>
<p>Then, we instantiate the <code class="docutils literal notranslate"><span class="pre">StandardScaler</span></code> object.</p>
<p>Subsequently, we use its <code class="docutils literal notranslate"><span class="pre">.fit()</span></code> method, passing the simulated data as input. Note here the use of the array’s <code class="docutils literal notranslate"><span class="pre">.reshape()</span></code> method, as StandardScaler objects require a 2D array.</p>
<p>At last, we create the rescaled data using <code class="docutils literal notranslate"><span class="pre">.transform()</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># synthetic data</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">10000000</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;x: mean = </span><span class="si">{</span><span class="n">x</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="si">}</span><span class="s2">, std = </span><span class="si">{</span><span class="n">x</span><span class="o">.</span><span class="n">std</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">scaler</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">()</span>
<span class="n">scaler</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
<span class="n">x_rescaled</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;x rescaled: mean = </span><span class="si">{</span><span class="n">x_rescaled</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="si">}</span><span class="s2">, std = </span><span class="si">{</span><span class="n">x_rescaled</span><span class="o">.</span><span class="n">std</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">x_rescaled</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>x: mean = 2.001558952373145, std = 5.0013510865961885
x rescaled: mean = -8.324178679686156e-16, std = 1.0
</pre></div>
</div>
<img alt="_images/Python_introduction_156_1.png" src="_images/Python_introduction_156_1.png" />
</div>
</div>
<p>We see the results printed above, with a mean of zero and a standard deviation of 1 (with a slight numerical deviation). From the histograms, we can also see that the transformed distribution on the right hand side is centered around zero, i.e. the mean is indeed shifted to zero.</p>
<p>It is important to disambiguate the two occurrences of <code class="docutils literal notranslate"><span class="pre">x.reshape(-1,1)</span></code> as argument to the methods:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">fit()</span></code>: the scaler ‘learns’ the parameters from the data, meaning it calculates the mean and std for this data specifically</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">transform()</span></code>: the scaler applies the parameters calculated in the step before to center and rescale the data in its argument. The parameters are fixed for the <code class="docutils literal notranslate"><span class="pre">scaler</span></code> object, as long as <code class="docutils literal notranslate"><span class="pre">.fit()</span></code> is not called again on different data.</p></li>
</ul>
<p>This means, that we can apply the same fitted parameters to another dataset using <code class="docutils literal notranslate"><span class="pre">.transform()</span></code> on this new data, as shown below.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x_alt</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">10000000</span><span class="p">)</span>
<span class="n">x_alt_scaled</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">x_alt</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;x_alt: mean = </span><span class="si">{</span><span class="n">x_alt_scaled</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="si">}</span><span class="s2">, std = </span><span class="si">{</span><span class="n">x_alt_scaled</span><span class="o">.</span><span class="n">std</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>x_alt: mean = -0.0002547058953381253, std = 0.9997587925541407
</pre></div>
</div>
</div>
</div>
<p>At last, let’s check what the fitted parameters are and do the ‘transform’ calculation ourselves to compare the result.</p>
<p>Fitted parameters in sklearn are saved as attributes to the fitting object, in this case <code class="docutils literal notranslate"><span class="pre">scaler</span></code>. We access them by <code class="docutils literal notranslate"><span class="pre">scaler.mean_</span></code> and <code class="docutils literal notranslate"><span class="pre">scaler.scale_</span></code>.
The mean of our calculation here reproduces the mean from the cell using the <code class="docutils literal notranslate"><span class="pre">.transform()</span></code> method.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">calc_result</span> <span class="o">=</span> <span class="n">x_alt</span> <span class="o">-</span> <span class="n">scaler</span><span class="o">.</span><span class="n">mean_</span>
<span class="n">calc_result</span> <span class="o">/=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">scale_</span>

<span class="nb">print</span><span class="p">(</span><span class="n">calc_result</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>

<span class="k">assert</span> <span class="n">calc_result</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span> <span class="o">==</span> <span class="n">x_alt_scaled</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-0.0002547058953381253
</pre></div>
</div>
</div>
</div>
<p>When we want to transform the data without having to keep the original data, we can use the shortcut method of <code class="docutils literal notranslate"><span class="pre">.fit_transform()</span></code>, which combines the two methods used before into one. The results are the same as for using first <code class="docutils literal notranslate"><span class="pre">.fit()</span></code> and then <code class="docutils literal notranslate"><span class="pre">transform()</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x_ft</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;x_alt: mean = </span><span class="si">{</span><span class="n">x_ft</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="si">}</span><span class="s2">, std = </span><span class="si">{</span><span class="n">x_ft</span><span class="o">.</span><span class="n">std</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>x_alt: mean = -8.324178679686156e-16, std = 1.0
</pre></div>
</div>
</div>
</div>
<p>There are more scaler types available in sklearn which can be applied using the same syntax as shown here.</p>
</div>
<div class="section" id="regression">
<h2>Regression<a class="headerlink" href="#regression" title="Permalink to this headline">¶</a></h2>
<div class="section" id="linear-regression">
<h3>Linear Regression<a class="headerlink" href="#linear-regression" title="Permalink to this headline">¶</a></h3>
<p>A popular and widely used tool in data analysis is linear regression where we model the the influence of some independent numerical variables on the value of a dependent numerical variable (the target).</p>
<p>We find the ordinary least squares regression readily available in sklearn’s module <code class="docutils literal notranslate"><span class="pre">linear_model</span></code> as the <code class="docutils literal notranslate"><span class="pre">LinearRegression</span></code> class. An important note here is that by default, sklearn will fit an intercept. To exclude the intercept, set <code class="docutils literal notranslate"><span class="pre">fit_intercept=False</span></code> when instantiating the <code class="docutils literal notranslate"><span class="pre">LinearRegression</span></code> object.</p>
<p>We will use a <a class="reference external" href="https://www.kaggle.com/mirichoi0218/insurance/version/1">health insurance data set</a> with several variables, which we will use to try to explain the charges taken for the policy. We do have some categorical variables, for which we would need to create dummy variables to use in the regression directly.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;data/insurance.csv&quot;</span><span class="p">)</span>
<span class="c1">#df = df.select_dtypes(include=[&#39;int64&#39;, &#39;float64&#39;])</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>age</th>
      <th>sex</th>
      <th>bmi</th>
      <th>children</th>
      <th>smoker</th>
      <th>region</th>
      <th>charges</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>19</td>
      <td>female</td>
      <td>27.90</td>
      <td>0</td>
      <td>yes</td>
      <td>southwest</td>
      <td>16884.9240</td>
    </tr>
    <tr>
      <th>1</th>
      <td>18</td>
      <td>male</td>
      <td>33.77</td>
      <td>1</td>
      <td>no</td>
      <td>southeast</td>
      <td>1725.5523</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>To perform a simple linear regression, we proceed similar to above:</p>
<ul class="simple">
<li><p>transform the pandas Series for independent and dependent variable to a numpy array, which we reshape to 2D</p></li>
<li><p>instantiate the object (default option <code class="docutils literal notranslate"><span class="pre">fit_intercept=True</span></code> included for illustrative reasons)</p></li>
<li><p>call the <code class="docutils literal notranslate"><span class="pre">.fit()</span></code> method with positional arguments: first independent variable X, then y</p></li>
</ul>
<p>At this point, the regression is done and we can access the parameters for the intercept and the variable’s coefficient. Again, the syntax is similar as above for the StandardScaler.</p>
<p>In this example, we regress the charges for a policy on the body mass index of the customer.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LinearRegression</span>

<span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">bmi</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">charges</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>

<span class="n">linreg</span> <span class="o">=</span> <span class="n">LinearRegression</span><span class="p">(</span><span class="n">fit_intercept</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">linreg</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;intercept: </span><span class="si">{</span><span class="n">linreg</span><span class="o">.</span><span class="n">intercept_</span><span class="si">}</span><span class="s2">, coefficient: </span><span class="si">{</span><span class="n">linreg</span><span class="o">.</span><span class="n">coef_</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>intercept: [1192.93720896], coefficient: [[393.8730308]]
</pre></div>
</div>
</div>
</div>
<p>What we find is a positive slope, <code class="docutils literal notranslate"><span class="pre">linreg.coef_</span></code> &gt; 0, meaning that a higher bmi results in higher charges. To be precise, if your bmi increases by one unit, you will, on average, be charged 394 units more.</p>
<p>We can also see that the estimated parameters are returned as (nested) arrays. To get to the values, we must hence extract them accordingly.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;intercept: </span><span class="si">{</span><span class="n">linreg</span><span class="o">.</span><span class="n">intercept_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">, coefficient: </span><span class="si">{</span><span class="n">linreg</span><span class="o">.</span><span class="n">coef_</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>intercept: 1192.9372089611497, coefficient: 393.87303079739524
</pre></div>
</div>
</div>
</div>
<p>Now, we can generate the regression line and plot it together with the data to get a visualisation of the regression results.</p>
<p>To do so, we simply pass the <code class="docutils literal notranslate"><span class="pre">X</span></code> values to the <code class="docutils literal notranslate"><span class="pre">.predict()</span></code> method and save the result as <code class="docutils literal notranslate"><span class="pre">y_pred</span></code>. We then use matplotlib to create a scatter plot of the data and a line plot of the regression line.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y_pred</span> <span class="o">=</span> <span class="n">linreg</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">y_pred</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/Python_introduction_172_0.png" src="_images/Python_introduction_172_0.png" />
</div>
</div>
<p>In the case above, we used the data “seen” for prediction. We can easily extrapolate this to unseen data, by simply predicting for a larger value range.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x_plot</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">80</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">y_extrapol</span> <span class="o">=</span> <span class="n">linreg</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">x_plot</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_plot</span><span class="p">,</span><span class="n">y_extrapol</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/Python_introduction_174_0.png" src="_images/Python_introduction_174_0.png" />
</div>
</div>
<p>While we can clearly identify the trend of higher charges for older customers we can also see what appears to be three different groups. We will try to go into a little more detail about this later.</p>
<p>To evaluate, how well our model explains the data, we can calculate different measures.
A quite common one is the coefficient of determination:</p>
<p>$$R^2 = 1 - \frac{\sum_i(y_i - \hat{y_i})^2}{\sum_i(y_i - \bar{y})^2}$$</p>
<p>With the predicted value $\hat{y_i}$ and the mean $\bar{y}$.</p>
<p>Thanks to sklearn, we do not have to calculate it from the results ourselves but find it in <code class="docutils literal notranslate"><span class="pre">sklearn.metrics</span></code>. To the <code class="docutils literal notranslate"><span class="pre">r2_score()</span></code> function, we pass as arguments the true y data and the prediction.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">r2_score</span>

<span class="n">r2_slr</span> <span class="o">=</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">r2_slr</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.03933913991786264
</pre></div>
</div>
</div>
</div>
<p>The result of about 4% is hardly satisfying and neither is the fit in the plot we saw above. From what we see in the graphic, the data may consist of different groups, one at the bottom and one stretching out on top. We will try to identify if we can identify them by variables in the data using seaborn’s <code class="docutils literal notranslate"><span class="pre">hue</span></code> option.</p>
<p>As a first guess, we can look at ‘smoker’, since smokers can be expected to be charged higher.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>

<span class="n">sns</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">bmi</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">charges</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">smoker</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/Python_introduction_178_0.png" src="_images/Python_introduction_178_0.png" />
</div>
</div>
<p>In fact, we see a rather clear distinction between smokers and non-smokers indicating that you will be charged higher in general when you smoke. It also appears that for smokers, the increase in charges is steeper for an increasing bmi than it is for non-smokers</p>
<p>We now split the data accordingly and run a regression for each group to see if we can verify these assumptions.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X_smoker</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">smoker</span> <span class="o">==</span><span class="s1">&#39;yes&#39;</span><span class="p">][</span><span class="s1">&#39;bmi&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">y_smoker</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">smoker</span> <span class="o">==</span><span class="s1">&#39;yes&#39;</span><span class="p">][</span><span class="s1">&#39;charges&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>

<span class="n">X_non_smoker</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">smoker</span> <span class="o">==</span><span class="s1">&#39;no&#39;</span><span class="p">][</span><span class="s1">&#39;bmi&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">y_non_smoker</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">smoker</span> <span class="o">==</span><span class="s1">&#39;no&#39;</span><span class="p">][</span><span class="s1">&#39;charges&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>

<span class="n">linreg_smoker</span> <span class="o">=</span> <span class="n">LinearRegression</span><span class="p">(</span><span class="n">fit_intercept</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">linreg_smoker</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_smoker</span><span class="p">,</span><span class="n">y_smoker</span><span class="p">)</span>

<span class="n">linreg_non_smoker</span> <span class="o">=</span> <span class="n">LinearRegression</span><span class="p">(</span><span class="n">fit_intercept</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">linreg_non_smoker</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_non_smoker</span><span class="p">,</span><span class="n">y_non_smoker</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;smoker: </span><span class="se">\n</span><span class="s2">intercept: </span><span class="si">{</span><span class="n">linreg_smoker</span><span class="o">.</span><span class="n">intercept_</span><span class="si">}</span><span class="s2">, coefficient: </span><span class="si">{</span><span class="n">linreg_smoker</span><span class="o">.</span><span class="n">coef_</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;non-smoker: </span><span class="se">\n</span><span class="s2">intercept: </span><span class="si">{</span><span class="n">linreg_non_smoker</span><span class="o">.</span><span class="n">intercept_</span><span class="si">}</span><span class="s2">, coefficient: </span><span class="si">{</span><span class="n">linreg_non_smoker</span><span class="o">.</span><span class="n">coef_</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>smoker: 
intercept: [-13186.57632276], coefficient: [[1473.1062547]]
non-smoker: 
intercept: [5879.42408187], coefficient: [[83.35055766]]
</pre></div>
</div>
</div>
</div>
<p>We see that the coefficient for the smokers is indeed much higher than for non-smokers. Regarding the intercept, we need to be aware, that it gives the value at bmi=0, which we should not consider relevant in reality.</p>
<p>Let’s also have a look at the plots.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y_pred_sm</span> <span class="o">=</span> <span class="n">linreg_smoker</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_smoker</span><span class="p">)</span>
<span class="n">y_pred_non</span> <span class="o">=</span> <span class="n">linreg_non_smoker</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_non_smoker</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X_smoker</span><span class="p">,</span> <span class="n">y_smoker</span><span class="p">,)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X_smoker</span><span class="p">,</span><span class="n">y_pred_sm</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X_non_smoker</span><span class="p">,</span> <span class="n">y_non_smoker</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X_non_smoker</span><span class="p">,</span><span class="n">y_pred_non</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/Python_introduction_182_0.png" src="_images/Python_introduction_182_0.png" />
</div>
</div>
<p>Finally, the $R^2$</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">r2_slr_sm</span> <span class="o">=</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">y_smoker</span><span class="p">,</span> <span class="n">y_pred_sm</span><span class="p">)</span>
<span class="n">r2_slr_non</span> <span class="o">=</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">y_non_smoker</span><span class="p">,</span> <span class="n">y_pred_non</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;smokers: </span><span class="si">{</span><span class="n">r2_slr_sm</span><span class="si">}</span><span class="s2">, </span><span class="se">\n</span><span class="s2">non-smokers: </span><span class="si">{</span><span class="n">r2_slr_non</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>smokers: 0.6504109694921547, 
non-smokers: 0.007062140580960441
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="digression-statsmodels">
<h3>Digression: statsmodels<a class="headerlink" href="#digression-statsmodels" title="Permalink to this headline">¶</a></h3>
<p>At this point, we shortly look at an important point when it comes to regression: significance. We skipped this above, because sklearn has its shortcomings when it comes to this kind of ‘classical statistics’. The calculation of p-values for example is not included and must be implemented by oneself.</p>
<p>For such purposes, we can switch to the <a class="reference external" href="https://www.statsmodels.org/stable/index.html">statsmodels package</a> which may be a better choice to do all types of regression modelling as it comes with a broad output of test statistics and performance metrics.</p>
<p>Below, an example is given for the regression from above with the just slightly different statsmodels syntax. We see that using the <code class="docutils literal notranslate"><span class="pre">.summary()</span></code> method automatically outputs a table of information about the model. We can now, for example, look at the significance of the coefficients.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">statsmodels.api</span> <span class="k">as</span> <span class="nn">sm</span>

<span class="n">X_smoker</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">add_constant</span><span class="p">(</span><span class="n">X_smoker</span><span class="p">)</span>
<span class="n">X_non_smoker</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">add_constant</span><span class="p">(</span><span class="n">X_non_smoker</span><span class="p">)</span>

<span class="n">stats_smoker</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">OLS</span><span class="p">(</span><span class="n">y_smoker</span><span class="p">,</span> <span class="n">X_smoker</span><span class="p">)</span>
<span class="n">res_smoker</span> <span class="o">=</span> <span class="n">stats_smoker</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">res_smoker</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                            OLS Regression Results                            
==============================================================================
Dep. Variable:                      y   R-squared:                       0.650
Model:                            OLS   Adj. R-squared:                  0.649
Method:                 Least Squares   F-statistic:                     506.1
Date:                Thu, 14 Oct 2021   Prob (F-statistic):           5.02e-64
Time:                        14:37:54   Log-Likelihood:                -2807.2
No. Observations:                 274   AIC:                             5618.
Df Residuals:                     272   BIC:                             5626.
Df Model:                           1                                         
Covariance Type:            nonrobust                                         
==============================================================================
                 coef    std err          t      P&gt;|t|      [0.025      0.975]
------------------------------------------------------------------------------
const      -1.319e+04   2052.885     -6.423      0.000   -1.72e+04   -9145.013
x1          1473.1063     65.484     22.496      0.000    1344.187    1602.026
==============================================================================
Omnibus:                       24.771   Durbin-Watson:                   1.878
Prob(Omnibus):                  0.000   Jarque-Bera (JB):               38.639
Skew:                           0.568   Prob(JB):                     4.07e-09
Kurtosis:                       4.447   Cond. No.                         156.
==============================================================================

Notes:
[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.
</pre></div>
</div>
</div>
</div>
<p>We can access the quantities from the table specifically, using the names listed when running <code class="docutils literal notranslate"><span class="pre">dir(res_smoker)</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">stats_non_smoker</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">OLS</span><span class="p">(</span><span class="n">y_non_smoker</span><span class="p">,</span> <span class="n">X_non_smoker</span><span class="p">)</span>
<span class="n">res_non_smoker</span> <span class="o">=</span> <span class="n">stats_non_smoker</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">res_non_smoker</span><span class="o">.</span><span class="n">pvalues</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[0.    0.006]
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="supervised-learning-random-forests">
<h2>Supervised learning: Random Forests<a class="headerlink" href="#supervised-learning-random-forests" title="Permalink to this headline">¶</a></h2>
<p>The broad field of machine learning can be subdivided into supervised learning, unsupervised learning and reinforcement learning. For the first two, sklearn offers a variety of algorithms as plug and play functions. We will look at one example of supervised learning while introducing some basic concepts.</p>
<p>We will train a classifier, i.e. a model that will predict a class for each observation. As we saw above, smokers and non smokers are separated quite well in the data. We would thus expect a model to learn to distinguish between those two classes.</p>
<p>We will use a <a class="reference external" href="https://link.springer.com/content/pdf/10.1023/A:1010933404324.pdf">Random Forest</a> model which basically consists of a collection of randomized, decorrelated decision trees. It is a powerful algorithm for classification and can be used out of the box in sklearn.</p>
<p>In the following, we</p>
<ul>
<li><p>import the <code class="docutils literal notranslate"><span class="pre">RandomForestClassifier</span></code> for which we can use the usual sklearn <code class="docutils literal notranslate"><span class="pre">.fit()</span></code> and <code class="docutils literal notranslate"><span class="pre">.predict()</span></code> syntax</p></li>
<li><p>import the <code class="docutils literal notranslate"><span class="pre">train_test_split()</span></code> function to create two separate sub-datasets from the original. This is a usual procedure in machine learning to check whether the model can generalize its prediction to new data. It randomly divides our X and y data into two parts each:</p>
<ul class="simple">
<li><p>predictor and target variables (of the same size) for training, i.e. fitting the model</p></li>
<li><p>predictor and target variables (of the same size) for testing, i.e. evaluating the performance. These observations are not used in the training/fitting process!</p></li>
</ul>
<p>We set the ratio <code class="docutils literal notranslate"><span class="pre">test_size</span></code> to 0.4, so that 40% of the observation are reserved for testing and thus have not been seen by the algorithm before.</p>
</li>
<li><p>import <code class="docutils literal notranslate"><span class="pre">roc_auc_score</span></code>, a <a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.metrics.roc_auc_score.html">metric which can be used to determine the performance of a classifier</a></p></li>
</ul>
<p>After creating the test and training datasets (using unpacking), we instantiate the random forest object and set <code class="docutils literal notranslate"><span class="pre">max_depth</span></code>, a hyper parameter, i.e. a model parameter which is not optimized by the algorithm but set by us, to four.</p>
<p>After the usual fit and predict calls, we print the roc-auc score using the test targets and the prediction for the test data.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">RandomForestClassifier</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">roc_auc_score</span>

<span class="n">X_rf</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="s1">&#39;age&#39;</span><span class="p">,</span> <span class="s1">&#39;bmi&#39;</span><span class="p">,</span> <span class="s1">&#39;children&#39;</span><span class="p">,</span> <span class="s1">&#39;charges&#39;</span><span class="p">]]</span>
<span class="n">y_rf</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">smoker</span> <span class="o">==</span> <span class="s1">&#39;yes&#39;</span>

<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X_rf</span><span class="p">,</span> <span class="n">y_rf</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span> <span class="mi">1</span><span class="p">)</span>

<span class="n">rf</span> <span class="o">=</span> <span class="n">RandomForestClassifier</span><span class="p">(</span><span class="n">max_depth</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">44</span><span class="p">)</span>
<span class="n">rf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span><span class="n">y_train</span><span class="p">)</span>

<span class="n">y_pred</span> <span class="o">=</span> <span class="n">rf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">roc_auc_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span><span class="n">y_pred</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.9755105572862581
</pre></div>
</div>
</div>
</div>
<p>A result of about 97% shows that the model can indeed distinguish between the two classes very well, using the given predictor variables.</p>
<p>While decision trees are very well interpretable, by drawing, random forests lose this advantage due to the high number of trees used. We can however access the single trees, using the <code class="docutils literal notranslate"><span class="pre">.estimators_</span></code> attribute after fitting the model. It is a list of the length of trees used, by default as used here 100:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">rf</span><span class="o">.</span><span class="n">estimators_</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>100
</pre></div>
</div>
</div>
</div>
<p>Now, as a last demonstration of sklearn user-friendliness, we use <code class="docutils literal notranslate"><span class="pre">plot_tree</span></code> to plot the first tree built by the random forest. It will create a tree diagram, showing information about the splits made at each node. Note, that our choice of <code class="docutils literal notranslate"><span class="pre">max_depth</span></code> is reflected by the four child generations of the tree.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.tree</span> <span class="kn">import</span> <span class="n">plot_tree</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">6</span><span class="p">),</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">120</span><span class="p">)</span>
<span class="n">plot_tree</span><span class="p">(</span><span class="n">rf</span><span class="o">.</span><span class="n">estimators_</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
          <span class="n">feature_names</span> <span class="o">=</span> <span class="n">X_rf</span><span class="o">.</span><span class="n">columns</span><span class="p">,</span>
          <span class="n">class_names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;smoker&#39;</span><span class="p">,</span> <span class="s1">&#39;non_smoker&#39;</span><span class="p">],</span>
          <span class="n">filled</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
          <span class="n">label</span><span class="o">=</span><span class="s1">&#39;root&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span> 
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/Python_introduction_196_0.png" src="_images/Python_introduction_196_0.png" />
</div>
</div>
</div>
</div>
<div class="section" id="tensorflow-keras">
<h1>TensorFlow: Keras<a class="headerlink" href="#tensorflow-keras" title="Permalink to this headline">¶</a></h1>
<p><a class="reference external" href="https://www.tensorflow.org">TensorFlow</a> is a machine learning and artificial intelligence platform. While including broad functionality, we will focus here on artificial neural networks (ANN). To build such networks, we will leverage the high level API <a class="reference external" href="https://keras.io/">Keras</a> and show here how to use ‘the sequential model’. This is allows to create the simplest form of neural networks, a fully connected feed forward structure. This unhandy term basically refers to a stack of so called layers of neurons, where one neuron of one layer is ‘connected’ to each neuron of the subsequent layer (as we won’t go into theoretic details: <a class="reference external" href="https://www.ling.upenn.edu/courses/cogs501/Rosenblatt1958.pdf">original paper</a>, <a class="reference external" href="https://en.wikipedia.org/wiki/Feedforward_neural_network">Wikipedia</a>, <a class="reference external" href="https://web.stanford.edu/~hastie/Papers/ESLII.pdf">The Elements of Statistical Learning, chapter 11</a>).</p>
<p>TensorFlow works with numpy arrays and pandas dataframes. We will now try to do a regression on some simulated data, using a neural network.</p>
<p>The package <code class="docutils literal notranslate"><span class="pre">tensorflow</span></code> must be installed.
To build neural networks, we start by importing the necessary modules. Note that Keras is delivered as a submodule to TensorFlow, which we can access using the dot chaining, and that we only import <code class="docutils literal notranslate"><span class="pre">layers</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">tensorflow</span> <span class="kn">import</span> <span class="n">keras</span><span class="p">,</span> <span class="n">random</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">random</span><span class="o">.</span><span class="n">set_seed</span><span class="p">(</span><span class="mi">102</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>We will write a function to simulate some data using numpy. We include a <code class="docutils literal notranslate"><span class="pre">noise</span></code> argument to be able to view the true function, which is obfuscated by the added noise.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">400</span><span class="p">))</span>

<span class="k">def</span> <span class="nf">make_data</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">_x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">noise</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">noise</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">a</span><span class="o">*</span><span class="n">_x</span> <span class="o">+</span> <span class="n">b</span><span class="o">*</span><span class="p">(</span><span class="n">_x</span><span class="o">-</span><span class="mi">4</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">c</span><span class="o">*</span><span class="n">_x</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">40</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">_x</span><span class="p">))</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">noise</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">a</span><span class="o">*</span><span class="n">_x</span> <span class="o">+</span> <span class="n">b</span><span class="o">*</span><span class="p">(</span><span class="n">_x</span><span class="o">-</span><span class="mi">4</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">c</span><span class="o">*</span><span class="n">_x</span><span class="o">**</span><span class="mi">3</span>

<span class="n">y</span> <span class="o">=</span> <span class="n">make_data</span><span class="p">(</span><span class="o">-</span><span class="mf">.5</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mf">1.5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">make_data</span><span class="p">(</span><span class="o">-</span><span class="mf">.5</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">noise</span><span class="o">=</span><span class="kc">False</span><span class="p">),</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">.5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/Python_introduction_201_0.png" src="_images/Python_introduction_201_0.png" />
</div>
</div>
<p>We define a very simple fully connected ANN with one hidden layer and only zwo neurons inside that layer. Since we aim to perform regression, we use one neuron in the output layer.
To do so in the code, we call <code class="docutils literal notranslate"><span class="pre">keras.Sequential</span></code> and add as argument all layers as a list. Elements of that list are <code class="docutils literal notranslate"><span class="pre">keras.layers.Dense</span></code> objects, which represent fully connected layers. Note that the order by which you define this list, corresponds to the stacking of the layers.
As arguments of <code class="docutils literal notranslate"><span class="pre">Dense</span></code>, we specify the number of neurons and the desired activation function. We may also give names to the layers, which might be ore useful for more complex net architectures.</p>
<p>Be aware that we do define an input shape here. Instead, we could let Keras do so automatically using the dimension of our input data. However, the specification of the input shape enables us to view the model summary without having to run anything else beforehand.</p>
<div class="cell tag_hide-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">Sequential</span><span class="p">([</span>
        <span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s2">&quot;relu&quot;</span><span class="p">,</span> <span class="n">input_shape</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,),</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;hidden_layer&quot;</span><span class="p">),</span>
        <span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;output_layer&quot;</span><span class="p">),</span>
<span class="p">],</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;my_first_model&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2021-10-14 14:37:58.081712: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
</pre></div>
</div>
</div>
</div>
<p>A summary of the defined model can be printed calling the method of the same name.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Model: &quot;my_first_model&quot;
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
hidden_layer (Dense)         (None, 2)                 4         
_________________________________________________________________
output_layer (Dense)         (None, 1)                 3         
=================================================================
Total params: 7
Trainable params: 7
Non-trainable params: 0
_________________________________________________________________
</pre></div>
</div>
</div>
</div>
<p>Having defined the model, we must compile, i.e. set the final configuration. We call the <code class="docutils literal notranslate"><span class="pre">.compile()</span></code> method on our model and specify the optimization algorithm (and the learning rate) and the loss function, by which the model should be trained. For regression, we use the mean squared error.</p>
<p>The learning rate is a hyper parameter and is to be chosen to suit the problem at hand. It’s possible to find an optimal rate by random or grid search, which we will not further discuss here.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">optimizer</span><span class="o">=</span><span class="n">keras</span><span class="o">.</span><span class="n">optimizers</span><span class="o">.</span><span class="n">RMSprop</span><span class="p">(</span><span class="n">learning_rate</span><span class="o">=</span><span class="mf">5e-2</span><span class="p">),</span> <span class="n">loss</span><span class="o">=</span><span class="n">keras</span><span class="o">.</span><span class="n">losses</span><span class="o">.</span><span class="n">MeanSquaredError</span><span class="p">(),</span> <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>We can now train the model, i.e. set the weights accordingly as to minimize the calculated error from deviations between model predictions and training data.</p>
<p>We do so by calling the <code class="docutils literal notranslate"><span class="pre">.fit()</span></code> method to which we supply the data and the number of episodes (iterations to tune the weights). Furthermore, we can set the <code class="docutils literal notranslate"><span class="pre">batch_size</span></code>, which defines the number of samples for which the weight updates are accumulated.</p>
<p>We can save all information returned from the fitting process in a <code class="docutils literal notranslate"><span class="pre">History</span></code> object, here called <code class="docutils literal notranslate"><span class="pre">history</span></code>. Through this object, we can access this information, once the fitting is done.</p>
<div class="cell tag_hide-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">history</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span> <span class="n">epochs</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2021-10-14 14:37:58.148520: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:185] None of the MLIR Optimization Passes are enabled (registered 2)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 1/150
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 1/14 [=&gt;............................] - ETA: 4s - loss: 7102.4404
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
14/14 [==============================] - 0s 638us/step - loss: 5327.5737
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 2/150

 1/14 [=&gt;............................] - ETA: 0s - loss: 6868.4395
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
14/14 [==============================] - 0s 560us/step - loss: 4656.4927
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 3/150

 1/14 [=&gt;............................] - ETA: 0s - loss: 4071.9622
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
14/14 [==============================] - 0s 563us/step - loss: 4034.6147
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 4/150

 1/14 [=&gt;............................] - ETA: 0s - loss: 4291.8213
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
14/14 [==============================] - 0s 559us/step - loss: 3462.9539
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 5/150

 1/14 [=&gt;............................] - ETA: 0s - loss: 2107.8840
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
14/14 [==============================] - 0s 559us/step - loss: 3193.3379
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 6/150

 1/14 [=&gt;............................] - ETA: 0s - loss: 2763.8831
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
14/14 [==============================] - 0s 560us/step - loss: 3164.3447
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 7/150

 1/14 [=&gt;............................] - ETA: 0s - loss: 2533.3293
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
14/14 [==============================] - 0s 565us/step - loss: 3124.7485
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 8/150

 1/14 [=&gt;............................] - ETA: 0s - loss: 2525.9072
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
14/14 [==============================] - 0s 542us/step - loss: 3114.0803
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 9/150

 1/14 [=&gt;............................] - ETA: 0s - loss: 4160.7583
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
14/14 [==============================] - 0s 526us/step - loss: 3081.1106
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 10/150

 1/14 [=&gt;............................] - ETA: 0s - loss: 3602.7991
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
14/14 [==============================] - 0s 492us/step - loss: 3059.7363
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 11/150

 1/14 [=&gt;............................] - ETA: 0s - loss: 3715.1692
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
14/14 [==============================] - 0s 524us/step - loss: 3033.1331
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 12/150

 1/14 [=&gt;............................] - ETA: 0s - loss: 3570.2798
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
14/14 [==============================] - 0s 524us/step - loss: 2994.3269
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 13/150

 1/14 [=&gt;............................] - ETA: 0s - loss: 2361.7927
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
14/14 [==============================] - 0s 534us/step - loss: 2976.7520
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 14/150

 1/14 [=&gt;............................] - ETA: 0s - loss: 4650.2661
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
14/14 [==============================] - 0s 521us/step - loss: 2934.5320
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 15/150

 1/14 [=&gt;............................] - ETA: 0s - loss: 2031.8308
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
14/14 [==============================] - 0s 548us/step - loss: 2922.7915
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 16/150

 1/14 [=&gt;............................] - ETA: 0s - loss: 4445.5713
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
14/14 [==============================] - 0s 517us/step - loss: 2886.0593
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 17/150

 1/14 [=&gt;............................] - ETA: 0s - loss: 2720.4519
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
14/14 [==============================] - 0s 530us/step - loss: 2863.1262
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 18/150

 1/14 [=&gt;............................] - ETA: 0s - loss: 3381.9250
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
14/14 [==============================] - 0s 513us/step - loss: 2834.8938
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 19/150

 1/14 [=&gt;............................] - ETA: 0s - loss: 2563.7932
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
14/14 [==============================] - 0s 534us/step - loss: 2802.9766
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 20/150

 1/14 [=&gt;............................] - ETA: 0s - loss: 2109.3479
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
14/14 [==============================] - 0s 538us/step - loss: 2775.1919
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 21/150

 1/14 [=&gt;............................] - ETA: 0s - loss: 1583.0344
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
14/14 [==============================] - 0s 517us/step - loss: 2740.8538
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 22/150

 1/14 [=&gt;............................] - ETA: 0s - loss: 2193.3813
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
14/14 [==============================] - 0s 538us/step - loss: 2715.2625
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 23/150

 1/14 [=&gt;............................] - ETA: 0s - loss: 3028.0376
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
14/14 [==============================] - 0s 534us/step - loss: 2681.9797
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 24/150

 1/14 [=&gt;............................] - ETA: 0s - loss: 3581.1736
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
14/14 [==============================] - 0s 530us/step - loss: 2655.4919
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 25/150

 1/14 [=&gt;............................] - ETA: 0s - loss: 2252.5864
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
14/14 [==============================] - 0s 526us/step - loss: 2621.0303
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 26/150

 1/14 [=&gt;............................] - ETA: 0s - loss: 3195.9016
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
14/14 [==============================] - 0s 544us/step - loss: 2588.0215
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 27/150

 1/14 [=&gt;............................] - ETA: 0s - loss: 1837.3928
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
14/14 [==============================] - 0s 507us/step - loss: 2553.3425
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 28/150

 1/14 [=&gt;............................] - ETA: 0s - loss: 2875.5110
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
14/14 [==============================] - 0s 547us/step - loss: 2528.7859
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 29/150

 1/14 [=&gt;............................] - ETA: 0s - loss: 2445.2944
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
14/14 [==============================] - 0s 541us/step - loss: 2488.1929
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 30/150

 1/14 [=&gt;............................] - ETA: 0s - loss: 2051.9700
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
14/14 [==============================] - 0s 527us/step - loss: 2469.8242
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 31/150

 1/14 [=&gt;............................] - ETA: 0s - loss: 1865.8108
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
14/14 [==============================] - 0s 539us/step - loss: 2453.7493
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 32/150

 1/14 [=&gt;............................] - ETA: 0s - loss: 2244.6477
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
14/14 [==============================] - 0s 537us/step - loss: 2422.7476
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 33/150

 1/14 [=&gt;............................] - ETA: 0s - loss: 2849.8901
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
14/14 [==============================] - 0s 547us/step - loss: 2396.8804
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 34/150

 1/14 [=&gt;............................] - ETA: 0s - loss: 2668.9927
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
14/14 [==============================] - 0s 523us/step - loss: 2369.4573
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 35/150

 1/14 [=&gt;............................] - ETA: 0s - loss: 2164.8328
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
14/14 [==============================] - 0s 530us/step - loss: 2349.6531
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 36/150

 1/14 [=&gt;............................] - ETA: 0s - loss: 1935.1899
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
14/14 [==============================] - 0s 508us/step - loss: 2326.9172
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 37/150

 1/14 [=&gt;............................] - ETA: 0s - loss: 2346.4587
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
14/14 [==============================] - 0s 529us/step - loss: 2316.8892
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 38/150

 1/14 [=&gt;............................] - ETA: 0s - loss: 2816.4570
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
14/14 [==============================] - 0s 524us/step - loss: 2307.8674
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 39/150

 1/14 [=&gt;............................] - ETA: 0s - loss: 2260.3555
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
14/14 [==============================] - 0s 508us/step - loss: 2278.9756
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 40/150

 1/14 [=&gt;............................] - ETA: 0s - loss: 2907.9021
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
14/14 [==============================] - 0s 510us/step - loss: 2272.0081
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 41/150

 1/14 [=&gt;............................] - ETA: 0s - loss: 1831.3917
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
14/14 [==============================] - 0s 516us/step - loss: 2245.4749
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 42/150

 1/14 [=&gt;............................] - ETA: 0s - loss: 1959.1604
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
14/14 [==============================] - 0s 528us/step - loss: 2237.1023
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 43/150

 1/14 [=&gt;............................] - ETA: 0s - loss: 2584.4807
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
14/14 [==============================] - 0s 505us/step - loss: 2212.1604
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 44/150
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 1/14 [=&gt;............................] - ETA: 0s - loss: 2143.3870
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
14/14 [==============================] - 0s 491us/step - loss: 2213.0767
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 45/150
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 1/14 [=&gt;............................] - ETA: 0s - loss: 2050.7253
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
14/14 [==============================] - 0s 533us/step - loss: 2179.8162
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 46/150
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 1/14 [=&gt;............................] - ETA: 0s - loss: 2487.8760
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
14/14 [==============================] - 0s 532us/step - loss: 2178.4517
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 47/150
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 1/14 [=&gt;............................] - ETA: 0s - loss: 2048.9480
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
14/14 [==============================] - 0s 537us/step - loss: 2164.9514
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 48/150

 1/14 [=&gt;............................] - ETA: 0s - loss: 2666.4385
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
14/14 [==============================] - 0s 516us/step - loss: 2146.8264
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 49/150
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 1/14 [=&gt;............................] - ETA: 0s - loss: 3297.1392
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
14/14 [==============================] - 0s 520us/step - loss: 2137.4805
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 50/150
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 1/14 [=&gt;............................] - ETA: 0s - loss: 1510.2360
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
14/14 [==============================] - 0s 537us/step - loss: 2128.6152
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 51/150
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 1/14 [=&gt;............................] - ETA: 0s - loss: 2452.0654
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
14/14 [==============================] - 0s 505us/step - loss: 2114.9731
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 52/150
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 1/14 [=&gt;............................] - ETA: 0s - loss: 2188.2544
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
14/14 [==============================] - 0s 504us/step - loss: 2102.6001
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 53/150
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 1/14 [=&gt;............................] - ETA: 0s - loss: 2043.8561
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
14/14 [==============================] - 0s 507us/step - loss: 2094.4380
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 54/150

 1/14 [=&gt;............................] - ETA: 0s - loss: 1622.0168
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
14/14 [==============================] - 0s 540us/step - loss: 2096.8625
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 55/150
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 1/14 [=&gt;............................] - ETA: 0s - loss: 2763.0708
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
14/14 [==============================] - 0s 539us/step - loss: 2088.4976
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 56/150

 1/14 [=&gt;............................] - ETA: 0s - loss: 2269.8975
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
14/14 [==============================] - 0s 525us/step - loss: 2072.5210
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 57/150

 1/14 [=&gt;............................] - ETA: 0s - loss: 1771.0404
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
14/14 [==============================] - 0s 507us/step - loss: 2073.9780
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 58/150

 1/14 [=&gt;............................] - ETA: 0s - loss: 2424.7656
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
14/14 [==============================] - 0s 507us/step - loss: 2068.1626
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 59/150

 1/14 [=&gt;............................] - ETA: 0s - loss: 2411.1147
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
14/14 [==============================] - 0s 531us/step - loss: 2055.4084
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 60/150

 1/14 [=&gt;............................] - ETA: 0s - loss: 1627.2854
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
14/14 [==============================] - 0s 538us/step - loss: 2048.7847
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 61/150

 1/14 [=&gt;............................] - ETA: 0s - loss: 2254.9407
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
14/14 [==============================] - 0s 494us/step - loss: 2057.4077
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 62/150

 1/14 [=&gt;............................] - ETA: 0s - loss: 2615.3625
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
14/14 [==============================] - 0s 505us/step - loss: 2037.8594
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 63/150

 1/14 [=&gt;............................] - ETA: 0s - loss: 2622.4797
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
14/14 [==============================] - 0s 514us/step - loss: 2041.7164
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 64/150

 1/14 [=&gt;............................] - ETA: 0s - loss: 2084.3984
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
14/14 [==============================] - 0s 528us/step - loss: 2047.7417
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 65/150

 1/14 [=&gt;............................] - ETA: 0s - loss: 2437.9854
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
14/14 [==============================] - 0s 505us/step - loss: 2032.6245
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 66/150

 1/14 [=&gt;............................] - ETA: 0s - loss: 2250.5764
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
14/14 [==============================] - 0s 493us/step - loss: 2033.1466
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 67/150

 1/14 [=&gt;............................] - ETA: 0s - loss: 1158.0978
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
14/14 [==============================] - 0s 533us/step - loss: 2029.8326
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 68/150

 1/14 [=&gt;............................] - ETA: 0s - loss: 1831.0441
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
14/14 [==============================] - 0s 523us/step - loss: 2034.2423
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 69/150

 1/14 [=&gt;............................] - ETA: 0s - loss: 2074.6040
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
14/14 [==============================] - 0s 525us/step - loss: 2018.6243
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 70/150

 1/14 [=&gt;............................] - ETA: 0s - loss: 1676.0665
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
14/14 [==============================] - 0s 523us/step - loss: 2013.9886
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 71/150

 1/14 [=&gt;............................] - ETA: 0s - loss: 2618.3931
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
14/14 [==============================] - 0s 516us/step - loss: 2024.0916
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 72/150

 1/14 [=&gt;............................] - ETA: 0s - loss: 1659.1710
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
14/14 [==============================] - 0s 500us/step - loss: 2028.6583
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 73/150

 1/14 [=&gt;............................] - ETA: 0s - loss: 2602.6084
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
14/14 [==============================] - 0s 524us/step - loss: 2009.5245
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 74/150

 1/14 [=&gt;............................] - ETA: 0s - loss: 1972.7734
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
14/14 [==============================] - 0s 533us/step - loss: 2004.3951
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 75/150

 1/14 [=&gt;............................] - ETA: 0s - loss: 2044.1779
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
14/14 [==============================] - 0s 542us/step - loss: 2017.4965
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 76/150

 1/14 [=&gt;............................] - ETA: 0s - loss: 2521.1711
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
14/14 [==============================] - 0s 512us/step - loss: 2007.4563
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 77/150

 1/14 [=&gt;............................] - ETA: 0s - loss: 2034.4097
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
14/14 [==============================] - 0s 543us/step - loss: 2005.2277
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 78/150

 1/14 [=&gt;............................] - ETA: 0s - loss: 2151.2710
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
14/14 [==============================] - 0s 527us/step - loss: 2012.2432
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 79/150

 1/14 [=&gt;............................] - ETA: 0s - loss: 2071.8083
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
14/14 [==============================] - 0s 510us/step - loss: 1993.1896
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 80/150

 1/14 [=&gt;............................] - ETA: 0s - loss: 2138.2695
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
14/14 [==============================] - 0s 488us/step - loss: 2014.3497
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 81/150

 1/14 [=&gt;............................] - ETA: 0s - loss: 1663.4609
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
14/14 [==============================] - 0s 518us/step - loss: 2006.1606
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 82/150

 1/14 [=&gt;............................] - ETA: 0s - loss: 1670.2152
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
14/14 [==============================] - 0s 494us/step - loss: 2005.4861
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 83/150

 1/14 [=&gt;............................] - ETA: 0s - loss: 1896.9410
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
14/14 [==============================] - 0s 521us/step - loss: 2008.5813
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 84/150

 1/14 [=&gt;............................] - ETA: 0s - loss: 2475.8337
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
14/14 [==============================] - 0s 508us/step - loss: 2014.5947
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 85/150

 1/14 [=&gt;............................] - ETA: 0s - loss: 2245.2192
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
14/14 [==============================] - 0s 500us/step - loss: 2011.0376
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 86/150

 1/14 [=&gt;............................] - ETA: 0s - loss: 2134.4761
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
14/14 [==============================] - 0s 483us/step - loss: 2007.7906
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 87/150

 1/14 [=&gt;............................] - ETA: 0s - loss: 1809.3333
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
14/14 [==============================] - 0s 506us/step - loss: 1999.2225
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 88/150

 1/14 [=&gt;............................] - ETA: 0s - loss: 2185.4641
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
14/14 [==============================] - 0s 504us/step - loss: 2003.0579
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 89/150

 1/14 [=&gt;............................] - ETA: 0s - loss: 2936.6926
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
14/14 [==============================] - 0s 509us/step - loss: 1999.1332
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 90/150

 1/14 [=&gt;............................] - ETA: 0s - loss: 1843.4901
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
14/14 [==============================] - 0s 532us/step - loss: 2006.7372
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 91/150

 1/14 [=&gt;............................] - ETA: 0s - loss: 1032.8199
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
14/14 [==============================] - 0s 524us/step - loss: 1999.1613
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 92/150

 1/14 [=&gt;............................] - ETA: 0s - loss: 2775.6641
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
14/14 [==============================] - 0s 505us/step - loss: 1996.6737
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 93/150

 1/14 [=&gt;............................] - ETA: 0s - loss: 3016.0408
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
14/14 [==============================] - 0s 514us/step - loss: 1997.5344
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 94/150

 1/14 [=&gt;............................] - ETA: 0s - loss: 1713.0195
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
14/14 [==============================] - 0s 515us/step - loss: 2000.8215
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 95/150

 1/14 [=&gt;............................] - ETA: 0s - loss: 1497.6541
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
14/14 [==============================] - 0s 533us/step - loss: 1995.7444
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 96/150

 1/14 [=&gt;............................] - ETA: 0s - loss: 2226.2896
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
14/14 [==============================] - 0s 513us/step - loss: 2000.6757
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 97/150

 1/14 [=&gt;............................] - ETA: 0s - loss: 1546.6414
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
14/14 [==============================] - 0s 505us/step - loss: 2000.7712
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 98/150

 1/14 [=&gt;............................] - ETA: 0s - loss: 1671.6747
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
14/14 [==============================] - 0s 523us/step - loss: 2001.3270
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 99/150

 1/14 [=&gt;............................] - ETA: 0s - loss: 1887.3054
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
14/14 [==============================] - 0s 534us/step - loss: 1981.8605
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 100/150

 1/14 [=&gt;............................] - ETA: 0s - loss: 1946.5651
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
14/14 [==============================] - 0s 525us/step - loss: 1991.0116
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 101/150

 1/14 [=&gt;............................] - ETA: 0s - loss: 1400.7787
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
14/14 [==============================] - 0s 531us/step - loss: 2011.7529
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 102/150

 1/14 [=&gt;............................] - ETA: 0s - loss: 1542.9531
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
14/14 [==============================] - 0s 527us/step - loss: 1989.5515
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 103/150

 1/14 [=&gt;............................] - ETA: 0s - loss: 2508.4675
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
14/14 [==============================] - 0s 523us/step - loss: 2006.1522
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 104/150

 1/14 [=&gt;............................] - ETA: 0s - loss: 1780.0187
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
14/14 [==============================] - 0s 526us/step - loss: 1999.3601
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 105/150

 1/14 [=&gt;............................] - ETA: 0s - loss: 2260.9895
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
14/14 [==============================] - 0s 548us/step - loss: 1998.5753
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 106/150

 1/14 [=&gt;............................] - ETA: 0s - loss: 1433.4530
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
14/14 [==============================] - 0s 559us/step - loss: 2005.2864
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 107/150

 1/14 [=&gt;............................] - ETA: 0s - loss: 1824.2643
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
14/14 [==============================] - 0s 587us/step - loss: 1985.4609
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 108/150
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 1/14 [=&gt;............................] - ETA: 0s - loss: 2733.9436
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
14/14 [==============================] - 0s 588us/step - loss: 1999.2024
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 109/150
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 1/14 [=&gt;............................] - ETA: 0s - loss: 1590.3708
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
14/14 [==============================] - 0s 534us/step - loss: 2002.7952
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 110/150

 1/14 [=&gt;............................] - ETA: 0s - loss: 1747.3147
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
14/14 [==============================] - 0s 500us/step - loss: 1993.0562
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 111/150

 1/14 [=&gt;............................] - ETA: 0s - loss: 2376.4028
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
14/14 [==============================] - 0s 514us/step - loss: 1994.1697
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 112/150

 1/14 [=&gt;............................] - ETA: 0s - loss: 1892.6840
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
14/14 [==============================] - 0s 518us/step - loss: 2001.7159
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 113/150

 1/14 [=&gt;............................] - ETA: 0s - loss: 1682.8890
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
14/14 [==============================] - 0s 508us/step - loss: 2002.8682
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 114/150

 1/14 [=&gt;............................] - ETA: 0s - loss: 2879.9346
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
14/14 [==============================] - 0s 520us/step - loss: 2001.8214
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 115/150

 1/14 [=&gt;............................] - ETA: 0s - loss: 1571.9719
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
14/14 [==============================] - 0s 526us/step - loss: 1997.3947
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 116/150

 1/14 [=&gt;............................] - ETA: 0s - loss: 2575.8997
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
14/14 [==============================] - 0s 538us/step - loss: 1997.4446
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 117/150

 1/14 [=&gt;............................] - ETA: 0s - loss: 1636.0804
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
14/14 [==============================] - 0s 530us/step - loss: 1984.7744
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 118/150

 1/14 [=&gt;............................] - ETA: 0s - loss: 1422.4246
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
14/14 [==============================] - 0s 508us/step - loss: 2007.8494
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 119/150

 1/14 [=&gt;............................] - ETA: 0s - loss: 2068.5051
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
14/14 [==============================] - 0s 541us/step - loss: 1987.6307
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 120/150

 1/14 [=&gt;............................] - ETA: 0s - loss: 2077.3230
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
14/14 [==============================] - 0s 517us/step - loss: 1998.6748
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 121/150

 1/14 [=&gt;............................] - ETA: 0s - loss: 1094.1482
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
14/14 [==============================] - 0s 519us/step - loss: 1995.1611
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 122/150

 1/14 [=&gt;............................] - ETA: 0s - loss: 1113.4916
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
14/14 [==============================] - 0s 519us/step - loss: 1981.4133
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 123/150

 1/14 [=&gt;............................] - ETA: 0s - loss: 2288.6824
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
14/14 [==============================] - 0s 507us/step - loss: 1996.3779
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 124/150

 1/14 [=&gt;............................] - ETA: 0s - loss: 2663.9585
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
14/14 [==============================] - 0s 512us/step - loss: 1982.5836
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 125/150

 1/14 [=&gt;............................] - ETA: 0s - loss: 2586.3757
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
14/14 [==============================] - 0s 500us/step - loss: 1981.0428
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 126/150

 1/14 [=&gt;............................] - ETA: 0s - loss: 1364.6488
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
14/14 [==============================] - 0s 511us/step - loss: 1969.7439
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 127/150

 1/14 [=&gt;............................] - ETA: 0s - loss: 2187.5588
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
14/14 [==============================] - 0s 515us/step - loss: 1984.7223
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 128/150

 1/14 [=&gt;............................] - ETA: 0s - loss: 1522.0692
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
14/14 [==============================] - 0s 509us/step - loss: 1994.0029
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 129/150

 1/14 [=&gt;............................] - ETA: 0s - loss: 1676.7986
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
14/14 [==============================] - 0s 524us/step - loss: 1988.0640
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 130/150
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 1/14 [=&gt;............................] - ETA: 0s - loss: 886.1827
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
14/14 [==============================] - 0s 529us/step - loss: 1984.9290
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 131/150

 1/14 [=&gt;............................] - ETA: 0s - loss: 1713.2935
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
14/14 [==============================] - 0s 504us/step - loss: 1996.4280
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 132/150

 1/14 [=&gt;............................] - ETA: 0s - loss: 2771.5601
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
14/14 [==============================] - 0s 515us/step - loss: 1991.8020
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 133/150

 1/14 [=&gt;............................] - ETA: 0s - loss: 1334.0625
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
14/14 [==============================] - 0s 505us/step - loss: 1987.2191
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 134/150

 1/14 [=&gt;............................] - ETA: 0s - loss: 2412.7346
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
14/14 [==============================] - 0s 514us/step - loss: 1985.0245
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 135/150

 1/14 [=&gt;............................] - ETA: 0s - loss: 2007.5292
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
14/14 [==============================] - 0s 523us/step - loss: 1977.6644
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 136/150

 1/14 [=&gt;............................] - ETA: 0s - loss: 1026.7963
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
14/14 [==============================] - 0s 534us/step - loss: 1996.8186
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 137/150

 1/14 [=&gt;............................] - ETA: 0s - loss: 1583.7083
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
14/14 [==============================] - 0s 515us/step - loss: 2008.7589
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 138/150

 1/14 [=&gt;............................] - ETA: 0s - loss: 2313.2798
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
14/14 [==============================] - 0s 525us/step - loss: 1990.2518
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 139/150

 1/14 [=&gt;............................] - ETA: 0s - loss: 2404.8257
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
14/14 [==============================] - 0s 510us/step - loss: 1984.2401
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 140/150

 1/14 [=&gt;............................] - ETA: 0s - loss: 1898.5560
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
14/14 [==============================] - 0s 529us/step - loss: 1993.4114
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 141/150

 1/14 [=&gt;............................] - ETA: 0s - loss: 1958.9031
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
14/14 [==============================] - 0s 514us/step - loss: 1993.1824
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 142/150

 1/14 [=&gt;............................] - ETA: 0s - loss: 3334.7703
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
14/14 [==============================] - 0s 508us/step - loss: 1987.4799
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 143/150

 1/14 [=&gt;............................] - ETA: 0s - loss: 1126.3513
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
14/14 [==============================] - 0s 517us/step - loss: 1995.8811
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 144/150

 1/14 [=&gt;............................] - ETA: 0s - loss: 1462.1898
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
14/14 [==============================] - 0s 528us/step - loss: 1981.5565
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 145/150

 1/14 [=&gt;............................] - ETA: 0s - loss: 1519.6849
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
14/14 [==============================] - 0s 488us/step - loss: 1987.2455
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 146/150

 1/14 [=&gt;............................] - ETA: 0s - loss: 1963.2502
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
14/14 [==============================] - 0s 484us/step - loss: 1981.4736
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 147/150

 1/14 [=&gt;............................] - ETA: 0s - loss: 2387.7861
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
14/14 [==============================] - 0s 515us/step - loss: 1977.4236
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 148/150

 1/14 [=&gt;............................] - ETA: 0s - loss: 2457.7041
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
14/14 [==============================] - 0s 505us/step - loss: 1989.7863
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 149/150

 1/14 [=&gt;............................] - ETA: 0s - loss: 1769.0211
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
14/14 [==============================] - 0s 502us/step - loss: 1974.7025
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 150/150

 1/14 [=&gt;............................] - ETA: 0s - loss: 1945.6375
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
14/14 [==============================] - 0s 501us/step - loss: 2001.7773
</pre></div>
</div>
</div>
</div>
<p>We get a printed output for each episode (click the plus symbol to show), showing some information about the step. Below the ‘Epochs’, we see that a batch size of 30 at a 300 observations results in 10 (300 divided by 30) updates per epoch.</p>
<p>Of more interest is the rightmost piece of information, the loss. As the weights are adjusted, the model predictions fit the data progressively better - the loss decreases. At some point, the model in its current configuration reaches an optimal weight setting and the loss will oscillate around some value.</p>
<p>Note that by setting <code class="docutils literal notranslate"><span class="pre">verbose=0</span></code>, we can suppress any output.</p>
<p>Using <code class="docutils literal notranslate"><span class="pre">history</span></code> we can now plot the loss over time/epochs. To do so, we use “our” <code class="docutils literal notranslate"><span class="pre">history</span></code> object and access its <code class="docutils literal notranslate"><span class="pre">.history</span></code> attribute, which is a dict:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">history</span><span class="o">.</span><span class="n">history</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">history</span><span class="o">.</span><span class="n">history</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;dict&#39;&gt;
dict_keys([&#39;loss&#39;])
</pre></div>
</div>
</div>
</div>
<p>Note that more values may be added to this dict. We will see this case for the next model.</p>
<p>With matplotlib, we plot the loss over time.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">history</span><span class="o">.</span><span class="n">history</span><span class="p">[</span><span class="s1">&#39;loss&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&lt;matplotlib.lines.Line2D at 0x7ff7437f3fa0&gt;]
</pre></div>
</div>
<img alt="_images/Python_introduction_213_1.png" src="_images/Python_introduction_213_1.png" />
</div>
</div>
<p>Apparently, the loss dropped very quickly in the beginning and reaches a minimal level after about 75 epochs.</p>
<p>Beside the <code class="docutils literal notranslate"><span class="pre">history</span></code> object, we can take a look at the trained weights by calling <code class="docutils literal notranslate"><span class="pre">model.get_weights()</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">layer</span> <span class="ow">in</span> <span class="n">model</span><span class="o">.</span><span class="n">layers</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">layer</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">: weights </span><span class="si">{</span><span class="n">layer</span><span class="o">.</span><span class="n">get_weights</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>hidden_layer: weights [array([[3.3640318, 3.6744   ]], dtype=float32), array([-11.734489,  -9.55885 ], dtype=float32)]
output_layer: weights [array([[15.183647],
       [ 8.534696]], dtype=float32), array([34.973118], dtype=float32)]
</pre></div>
</div>
</div>
</div>
<p>For each layer, we see the number of entries corresponding to ‘params’ in the model summary above. The first array per layer gives the weights, the second array the bias.</p>
<p>Note here, that it is perfectly possible to save the weights of a model, e.g. in a file, and then load this model again later by setting these weights to the model weights. Of course, the model configuration must remain the same in order to use the weights. However, the already implemented <code class="docutils literal notranslate"><span class="pre">.save('my_path')</span></code> method does exactly that. To load the model, use <code class="docutils literal notranslate"><span class="pre">.model.load('my_path')</span></code>.</p>
<p>To see the predictions from our model, we use the <code class="docutils literal notranslate"><span class="pre">.predict()</span></code> method, to which we only pass the x values, and store the result in a variable.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y_pred</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Finally, we can get a look on how this simple neural network approximates our data:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y_pred</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/Python_introduction_219_0.png" src="_images/Python_introduction_219_0.png" />
</div>
</div>
<p>Interestingly, the ReLU shape of the function can be seen rather clearly.</p>
<p>Now, let’s try to do better than that.</p>
<div class="section" id="a-more-complex-model">
<h2>A more complex model<a class="headerlink" href="#a-more-complex-model" title="Permalink to this headline">¶</a></h2>
<p>We will now test if a more flexible, more complex model with more layers and neurons, will approximate the data more accurately</p>
<p>First, we define a this new model as seen above.</p>
<div class="cell tag_remove-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">random</span><span class="o">.</span><span class="n">set_seed</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span>

<span class="n">better_model</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">Sequential</span><span class="p">([</span>
        <span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">22</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s2">&quot;relu&quot;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;l1&quot;</span><span class="p">),</span>
        <span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s2">&quot;relu&quot;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;l2&quot;</span><span class="p">),</span>
        <span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;lo&quot;</span><span class="p">),</span>
<span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<p>We will try a smaller learning rate (and may thus increase the number of epochs).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">better_model</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">optimizer</span><span class="o">=</span><span class="n">keras</span><span class="o">.</span><span class="n">optimizers</span><span class="o">.</span><span class="n">RMSprop</span><span class="p">(</span><span class="n">learning_rate</span><span class="o">=</span><span class="mf">6e-3</span><span class="p">),</span> <span class="n">loss</span><span class="o">=</span><span class="n">keras</span><span class="o">.</span><span class="n">losses</span><span class="o">.</span><span class="n">MeanSquaredError</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
<p>Usually, when training a model, we split the data into a training and test set. We will do this using sklearn’s <code class="docutils literal notranslate"><span class="pre">train_test_split</span></code>. Conveniently, in Keras, we can pass the validation data using the <code class="docutils literal notranslate"><span class="pre">validation_data</span></code> argument of <code class="docutils literal notranslate"><span class="pre">.fit()</span></code>.</p>
<p>Another possibility is to use <code class="docutils literal notranslate"><span class="pre">validation_split</span></code>, which will, when set for example to <code class="docutils literal notranslate"><span class="pre">.2</span></code>, omit 20% of the training data and evaluate the performance for this “unknown” part of the data. Beware, that this will only work for shuffled data, as the validation data is taken from the last entries of the data.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>

<span class="n">x_train</span><span class="p">,</span> <span class="n">x_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.15</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span> <span class="mi">22</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">better_history</span> <span class="o">=</span> <span class="n">better_model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">x_train</span><span class="p">,</span><span class="n">y_train</span><span class="p">,</span> <span class="n">epochs</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">validation_data</span><span class="o">=</span><span class="p">(</span><span class="n">x_test</span><span class="p">,</span><span class="n">y_test</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 1/200
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 1/11 [=&gt;............................] - ETA: 2s - loss: 7355.4893
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
11/11 [==============================] - 0s 10ms/step - loss: 5195.4502 - val_loss: 5952.9858
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 2/200

 1/11 [=&gt;............................] - ETA: 0s - loss: 5334.2344
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
11/11 [==============================] - 0s 2ms/step - loss: 4777.6235 - val_loss: 5292.6206
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 3/200

 1/11 [=&gt;............................] - ETA: 0s - loss: 6269.8213
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
11/11 [==============================] - 0s 2ms/step - loss: 4263.1826 - val_loss: 4532.9067
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 4/200

 1/11 [=&gt;............................] - ETA: 0s - loss: 3376.2676
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
11/11 [==============================] - 0s 2ms/step - loss: 3719.0327 - val_loss: 3797.6614
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 5/200

 1/11 [=&gt;............................] - ETA: 0s - loss: 5572.9492
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
11/11 [==============================] - 0s 2ms/step - loss: 3260.8635 - val_loss: 3174.2229
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 6/200

 1/11 [=&gt;............................] - ETA: 0s - loss: 2918.0955
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
11/11 [==============================] - 0s 2ms/step - loss: 2915.1924 - val_loss: 2768.2920
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 7/200

 1/11 [=&gt;............................] - ETA: 0s - loss: 2286.9961
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
11/11 [==============================] - 0s 2ms/step - loss: 2730.0264 - val_loss: 2575.4263
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 8/200

 1/11 [=&gt;............................] - ETA: 0s - loss: 2027.2507
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
11/11 [==============================] - 0s 2ms/step - loss: 2646.8606 - val_loss: 2467.6365
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 9/200

 1/11 [=&gt;............................] - ETA: 0s - loss: 1535.8545
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
11/11 [==============================] - 0s 2ms/step - loss: 2605.6108 - val_loss: 2450.9114
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 10/200

 1/11 [=&gt;............................] - ETA: 0s - loss: 2589.7134
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
11/11 [==============================] - 0s 2ms/step - loss: 2601.1738 - val_loss: 2478.9314
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 11/200

 1/11 [=&gt;............................] - ETA: 0s - loss: 2181.2183
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
11/11 [==============================] - 0s 2ms/step - loss: 2596.9385 - val_loss: 2426.5391
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 12/200

 1/11 [=&gt;............................] - ETA: 0s - loss: 3096.9011
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
11/11 [==============================] - 0s 2ms/step - loss: 2576.7681 - val_loss: 2405.7380
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 13/200

 1/11 [=&gt;............................] - ETA: 0s - loss: 1402.6896
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
11/11 [==============================] - 0s 2ms/step - loss: 2565.5618 - val_loss: 2421.0476
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 14/200

 1/11 [=&gt;............................] - ETA: 0s - loss: 2397.7629
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
11/11 [==============================] - 0s 2ms/step - loss: 2554.0518 - val_loss: 2410.6890
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 15/200

 1/11 [=&gt;............................] - ETA: 0s - loss: 2530.6350
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
11/11 [==============================] - 0s 2ms/step - loss: 2562.0688 - val_loss: 2405.7273
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 16/200

 1/11 [=&gt;............................] - ETA: 0s - loss: 2752.2339
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
11/11 [==============================] - 0s 2ms/step - loss: 2538.2214 - val_loss: 2424.1265
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 17/200
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 1/11 [=&gt;............................] - ETA: 0s - loss: 1539.3413
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
11/11 [==============================] - 0s 2ms/step - loss: 2539.6079 - val_loss: 2430.3191
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 18/200

 1/11 [=&gt;............................] - ETA: 0s - loss: 1800.7311
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
11/11 [==============================] - 0s 2ms/step - loss: 2522.1934 - val_loss: 2439.9604
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 19/200

 1/11 [=&gt;............................] - ETA: 0s - loss: 3250.2200
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
11/11 [==============================] - 0s 2ms/step - loss: 2519.2222 - val_loss: 2398.1340
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 20/200

 1/11 [=&gt;............................] - ETA: 0s - loss: 2596.8647
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
11/11 [==============================] - 0s 2ms/step - loss: 2515.6399 - val_loss: 2405.0598
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 21/200

 1/11 [=&gt;............................] - ETA: 0s - loss: 2943.9487
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
11/11 [==============================] - 0s 2ms/step - loss: 2508.9673 - val_loss: 2411.2634
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 22/200

 1/11 [=&gt;............................] - ETA: 0s - loss: 2782.8247
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
11/11 [==============================] - 0s 2ms/step - loss: 2483.3711 - val_loss: 2374.7527
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 23/200

 1/11 [=&gt;............................] - ETA: 0s - loss: 3708.2910
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
11/11 [==============================] - 0s 2ms/step - loss: 2480.6343 - val_loss: 2371.9375
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 24/200

 1/11 [=&gt;............................] - ETA: 0s - loss: 3270.9648
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
11/11 [==============================] - 0s 2ms/step - loss: 2469.3062 - val_loss: 2352.8044
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 25/200

 1/11 [=&gt;............................] - ETA: 0s - loss: 3576.4839
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
11/11 [==============================] - 0s 2ms/step - loss: 2458.1709 - val_loss: 2337.6414
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 26/200

 1/11 [=&gt;............................] - ETA: 0s - loss: 2464.8533
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
11/11 [==============================] - 0s 2ms/step - loss: 2446.1880 - val_loss: 2310.5779
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 27/200

 1/11 [=&gt;............................] - ETA: 0s - loss: 1484.3484
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
11/11 [==============================] - 0s 2ms/step - loss: 2437.1504 - val_loss: 2331.0928
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 28/200

 1/11 [=&gt;............................] - ETA: 0s - loss: 3066.8313
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
11/11 [==============================] - 0s 2ms/step - loss: 2422.3359 - val_loss: 2325.5913
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 29/200

 1/11 [=&gt;............................] - ETA: 0s - loss: 2431.2803
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
11/11 [==============================] - 0s 2ms/step - loss: 2413.6270 - val_loss: 2293.8818
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 30/200
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 1/11 [=&gt;............................] - ETA: 0s - loss: 3157.0620
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
11/11 [==============================] - 0s 2ms/step - loss: 2398.3315 - val_loss: 2270.2021
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 31/200
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 1/11 [=&gt;............................] - ETA: 0s - loss: 3471.7134
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
11/11 [==============================] - 0s 2ms/step - loss: 2389.8323 - val_loss: 2255.0505
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 32/200

 1/11 [=&gt;............................] - ETA: 0s - loss: 2251.5366
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
11/11 [==============================] - 0s 2ms/step - loss: 2372.1538 - val_loss: 2264.3367
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 33/200

 1/11 [=&gt;............................] - ETA: 0s - loss: 2010.0458
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
11/11 [==============================] - 0s 2ms/step - loss: 2362.3352 - val_loss: 2255.7349
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 34/200

 1/11 [=&gt;............................] - ETA: 0s - loss: 1826.4407
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
11/11 [==============================] - 0s 2ms/step - loss: 2346.5144 - val_loss: 2238.2686
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 35/200

 1/11 [=&gt;............................] - ETA: 0s - loss: 1876.3483
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
11/11 [==============================] - 0s 2ms/step - loss: 2328.5088 - val_loss: 2243.9241
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 36/200

 1/11 [=&gt;............................] - ETA: 0s - loss: 2396.7764
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
11/11 [==============================] - 0s 2ms/step - loss: 2321.7129 - val_loss: 2210.1760
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 37/200

 1/11 [=&gt;............................] - ETA: 0s - loss: 2160.0771
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
11/11 [==============================] - 0s 2ms/step - loss: 2309.6121 - val_loss: 2221.5925
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 38/200

 1/11 [=&gt;............................] - ETA: 0s - loss: 2974.2324
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
11/11 [==============================] - 0s 2ms/step - loss: 2282.8628 - val_loss: 2191.4546
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 39/200

 1/11 [=&gt;............................] - ETA: 0s - loss: 2830.8486
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
11/11 [==============================] - 0s 2ms/step - loss: 2264.1162 - val_loss: 2191.1824
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 40/200

 1/11 [=&gt;............................] - ETA: 0s - loss: 1933.8970
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
11/11 [==============================] - 0s 2ms/step - loss: 2261.1936 - val_loss: 2171.6191
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 41/200

 1/11 [=&gt;............................] - ETA: 0s - loss: 2741.6440
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
11/11 [==============================] - 0s 2ms/step - loss: 2247.4163 - val_loss: 2168.1648
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 42/200

 1/11 [=&gt;............................] - ETA: 0s - loss: 2020.8113
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
11/11 [==============================] - 0s 2ms/step - loss: 2226.2876 - val_loss: 2123.1199
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 43/200

 1/11 [=&gt;............................] - ETA: 0s - loss: 2049.1187
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
11/11 [==============================] - 0s 2ms/step - loss: 2214.5110 - val_loss: 2142.9216
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 44/200

 1/11 [=&gt;............................] - ETA: 0s - loss: 3938.2461
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
11/11 [==============================] - 0s 2ms/step - loss: 2189.9089 - val_loss: 2159.7549
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 45/200

 1/11 [=&gt;............................] - ETA: 0s - loss: 1967.3003
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
11/11 [==============================] - 0s 2ms/step - loss: 2190.9070 - val_loss: 2141.3577
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 46/200

 1/11 [=&gt;............................] - ETA: 0s - loss: 1869.0098
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
11/11 [==============================] - 0s 2ms/step - loss: 2183.2673 - val_loss: 2094.3540
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 47/200

 1/11 [=&gt;............................] - ETA: 0s - loss: 1240.2473
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
11/11 [==============================] - 0s 2ms/step - loss: 2151.4451 - val_loss: 2035.6704
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 48/200

 1/11 [=&gt;............................] - ETA: 0s - loss: 1302.0085
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
11/11 [==============================] - 0s 2ms/step - loss: 2152.7852 - val_loss: 2073.4587
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 49/200

 1/11 [=&gt;............................] - ETA: 0s - loss: 2010.9407
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
11/11 [==============================] - 0s 2ms/step - loss: 2131.5461 - val_loss: 2050.9597
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 50/200

 1/11 [=&gt;............................] - ETA: 0s - loss: 3716.7373
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
11/11 [==============================] - 0s 2ms/step - loss: 2124.6780 - val_loss: 2080.6274
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 51/200

 1/11 [=&gt;............................] - ETA: 0s - loss: 1869.8092
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
11/11 [==============================] - 0s 2ms/step - loss: 2101.1318 - val_loss: 2074.6641
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 52/200

 1/11 [=&gt;............................] - ETA: 0s - loss: 2108.1982
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
11/11 [==============================] - 0s 2ms/step - loss: 2096.6125 - val_loss: 2058.7070
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 53/200

 1/11 [=&gt;............................] - ETA: 0s - loss: 1683.4108
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
11/11 [==============================] - 0s 2ms/step - loss: 2077.0525 - val_loss: 2012.2570
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 54/200

 1/11 [=&gt;............................] - ETA: 0s - loss: 1567.1228
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
11/11 [==============================] - 0s 2ms/step - loss: 2043.5333 - val_loss: 2149.3271
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 55/200

 1/11 [=&gt;............................] - ETA: 0s - loss: 2046.0406
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
11/11 [==============================] - 0s 2ms/step - loss: 2061.6543 - val_loss: 1992.6205
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 56/200

 1/11 [=&gt;............................] - ETA: 0s - loss: 1900.9786
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
11/11 [==============================] - 0s 2ms/step - loss: 2039.2875 - val_loss: 2038.7491
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 57/200

 1/11 [=&gt;............................] - ETA: 0s - loss: 2257.1252
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
11/11 [==============================] - 0s 2ms/step - loss: 2021.2185 - val_loss: 2048.6101
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 58/200

 1/11 [=&gt;............................] - ETA: 0s - loss: 1516.5685
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
11/11 [==============================] - 0s 2ms/step - loss: 2020.4180 - val_loss: 2017.0846
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 59/200

 1/11 [=&gt;............................] - ETA: 0s - loss: 2471.0815
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
11/11 [==============================] - 0s 2ms/step - loss: 2005.3186 - val_loss: 1996.6440
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 60/200

 1/11 [=&gt;............................] - ETA: 0s - loss: 1538.1586
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
11/11 [==============================] - 0s 2ms/step - loss: 1985.3584 - val_loss: 1985.9298
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 61/200

 1/11 [=&gt;............................] - ETA: 0s - loss: 2542.9878
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
11/11 [==============================] - 0s 2ms/step - loss: 1966.4020 - val_loss: 1962.4807
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 62/200

 1/11 [=&gt;............................] - ETA: 0s - loss: 1260.3511
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
11/11 [==============================] - 0s 2ms/step - loss: 1961.6105 - val_loss: 2068.6460
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 63/200

 1/11 [=&gt;............................] - ETA: 0s - loss: 1038.0908
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
11/11 [==============================] - 0s 2ms/step - loss: 1952.9945 - val_loss: 1964.2216
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 64/200

 1/11 [=&gt;............................] - ETA: 0s - loss: 2019.5428
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
11/11 [==============================] - 0s 2ms/step - loss: 1941.0806 - val_loss: 1964.0831
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 65/200

 1/11 [=&gt;............................] - ETA: 0s - loss: 2087.9656
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
11/11 [==============================] - 0s 2ms/step - loss: 1924.4467 - val_loss: 1974.6440
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 66/200

 1/11 [=&gt;............................] - ETA: 0s - loss: 2344.8074
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
11/11 [==============================] - 0s 2ms/step - loss: 1930.3451 - val_loss: 1942.5341
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 67/200

 1/11 [=&gt;............................] - ETA: 0s - loss: 2979.8521
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
11/11 [==============================] - 0s 2ms/step - loss: 1917.3059 - val_loss: 1930.8588
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 68/200

 1/11 [=&gt;............................] - ETA: 0s - loss: 2420.6636
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
11/11 [==============================] - 0s 2ms/step - loss: 1907.9752 - val_loss: 1923.8265
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 69/200

 1/11 [=&gt;............................] - ETA: 0s - loss: 1780.0560
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
11/11 [==============================] - 0s 2ms/step - loss: 1907.4841 - val_loss: 1918.4310
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 70/200

 1/11 [=&gt;............................] - ETA: 0s - loss: 3082.0625
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
11/11 [==============================] - 0s 2ms/step - loss: 1892.7394 - val_loss: 1884.8479
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 71/200

 1/11 [=&gt;............................] - ETA: 0s - loss: 2001.2855
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
11/11 [==============================] - 0s 2ms/step - loss: 1887.9862 - val_loss: 1903.0765
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 72/200

 1/11 [=&gt;............................] - ETA: 0s - loss: 1646.9301
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
11/11 [==============================] - 0s 2ms/step - loss: 1888.6083 - val_loss: 1946.2745
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 73/200

 1/11 [=&gt;............................] - ETA: 0s - loss: 2082.5569
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
11/11 [==============================] - 0s 2ms/step - loss: 1862.2355 - val_loss: 2029.7162
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 74/200

 1/11 [=&gt;............................] - ETA: 0s - loss: 2117.5098
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
11/11 [==============================] - 0s 2ms/step - loss: 1877.1215 - val_loss: 1984.1516
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 75/200

 1/11 [=&gt;............................] - ETA: 0s - loss: 801.1807
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
11/11 [==============================] - 0s 2ms/step - loss: 1849.7292 - val_loss: 1983.2487
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 76/200

 1/11 [=&gt;............................] - ETA: 0s - loss: 1339.7419
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
11/11 [==============================] - 0s 2ms/step - loss: 1854.9781 - val_loss: 2017.5710
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 77/200

 1/11 [=&gt;............................] - ETA: 0s - loss: 1673.1943
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
11/11 [==============================] - 0s 2ms/step - loss: 1851.8279 - val_loss: 1966.7147
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 78/200

 1/11 [=&gt;............................] - ETA: 0s - loss: 2170.8335
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
11/11 [==============================] - 0s 2ms/step - loss: 1846.7617 - val_loss: 1930.5232
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 79/200

 1/11 [=&gt;............................] - ETA: 0s - loss: 1481.0911
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
11/11 [==============================] - 0s 2ms/step - loss: 1835.5542 - val_loss: 1963.5775
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 80/200

 1/11 [=&gt;............................] - ETA: 0s - loss: 1814.1150
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
11/11 [==============================] - 0s 2ms/step - loss: 1836.0559 - val_loss: 1968.9784
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 81/200

 1/11 [=&gt;............................] - ETA: 0s - loss: 1526.6423
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
11/11 [==============================] - 0s 2ms/step - loss: 1819.0316 - val_loss: 1928.5581
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 82/200

 1/11 [=&gt;............................] - ETA: 0s - loss: 1494.1646
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
11/11 [==============================] - 0s 2ms/step - loss: 1836.6104 - val_loss: 1887.4347
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 83/200

 1/11 [=&gt;............................] - ETA: 0s - loss: 1671.4377
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
11/11 [==============================] - 0s 2ms/step - loss: 1815.2471 - val_loss: 1944.8075
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 84/200

 1/11 [=&gt;............................] - ETA: 0s - loss: 1716.0752
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
11/11 [==============================] - 0s 2ms/step - loss: 1814.4451 - val_loss: 1977.1581
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 85/200

 1/11 [=&gt;............................] - ETA: 0s - loss: 1345.0966
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
11/11 [==============================] - 0s 2ms/step - loss: 1814.4285 - val_loss: 1944.6068
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 86/200

 1/11 [=&gt;............................] - ETA: 0s - loss: 1474.5500
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
11/11 [==============================] - 0s 2ms/step - loss: 1819.7806 - val_loss: 1978.4865
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 87/200

 1/11 [=&gt;............................] - ETA: 0s - loss: 1292.1292
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
11/11 [==============================] - 0s 2ms/step - loss: 1806.7257 - val_loss: 1966.5315
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 88/200

 1/11 [=&gt;............................] - ETA: 0s - loss: 1455.2026
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
11/11 [==============================] - 0s 2ms/step - loss: 1796.1560 - val_loss: 1895.8748
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 89/200

 1/11 [=&gt;............................]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> - ETA: 0s - loss: 2434.1382
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
11/11 [==============================] - 0s 2ms/step - loss: 1800.8871 - val_loss: 1916.6573
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 90/200

 1/11 [=&gt;............................] - ETA: 0s - loss: 2112.4575
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
11/11 [==============================] - 0s 2ms/step - loss: 1804.6774 - val_loss: 1874.5831
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 91/200
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 1/11 [=&gt;............................] - ETA: 0s - loss: 2303.5183
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
11/11 [==============================] - 0s 2ms/step - loss: 1805.9667 - val_loss: 1912.0317
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 92/200
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 1/11 [=&gt;............................] - ETA: 0s - loss: 1506.8158
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
11/11 [==============================] - 0s 2ms/step - loss: 1800.2841 - val_loss: 1929.5978
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 93/200
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 1/11 [=&gt;............................] - ETA: 0s - loss: 2001.6721
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
11/11 [==============================] - 0s 2ms/step - loss: 1799.8925 - val_loss: 1986.0490
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 94/200
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 1/11 [=&gt;............................] - ETA: 0s - loss: 1729.8861
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
11/11 [==============================] - 0s 2ms/step - loss: 1796.9886 - val_loss: 1938.4906
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 95/200
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 1/11 [=&gt;............................] - ETA: 0s - loss: 2298.9119
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
11/11 [==============================] - 0s 2ms/step - loss: 1791.9371 - val_loss: 1899.6385
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 96/200
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 1/11 [=&gt;............................] - ETA: 0s - loss: 1611.1428
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
11/11 [==============================] - 0s 2ms/step - loss: 1780.1392 - val_loss: 1871.6234
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 97/200

 1/11 [=&gt;............................] - ETA: 0s - loss: 2252.7795
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
11/11 [==============================] - 0s 2ms/step - loss: 1792.3313 - val_loss: 1898.4563
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 98/200
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 1/11 [=&gt;............................] - ETA: 0s - loss: 1632.1898
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
11/11 [==============================] - 0s 2ms/step - loss: 1783.7950 - val_loss: 1911.2336
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 99/200
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 1/11 [=&gt;............................] - ETA: 0s - loss: 870.0477
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
11/11 [==============================] - 0s 2ms/step - loss: 1774.4697 - val_loss: 1927.0756
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 100/200
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 1/11 [=&gt;............................] - ETA: 0s - loss: 1931.3293
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
11/11 [==============================] - 0s 2ms/step - loss: 1770.7217 - val_loss: 1848.1676
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 101/200
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 1/11 [=&gt;............................] - ETA: 0s - loss: 2078.3289
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
11/11 [==============================] - 0s 2ms/step - loss: 1772.6854 - val_loss: 1912.8571
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 102/200
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 1/11 [=&gt;............................] - ETA: 0s - loss: 2278.9600
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
11/11 [==============================] - 0s 2ms/step - loss: 1787.7471 - val_loss: 1905.8479
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 103/200
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 1/11 [=&gt;............................] - ETA: 0s - loss: 1228.9392
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
11/11 [==============================] - 0s 2ms/step - loss: 1772.6268 - val_loss: 1895.1328
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 104/200
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 1/11 [=&gt;............................] - ETA: 0s - loss: 2190.4988
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
11/11 [==============================] - 0s 2ms/step - loss: 1769.1592 - val_loss: 1905.3479
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 105/200

 1/11 [=&gt;............................] - ETA: 0s - loss: 1118.6240
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
11/11 [==============================] - 0s 2ms/step - loss: 1771.8818 - val_loss: 1994.5588
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 106/200
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 1/11 [=&gt;............................] - ETA: 0s - loss: 2446.0312
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
11/11 [==============================] - 0s 2ms/step - loss: 1772.1348 - val_loss: 1938.5558
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 107/200
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 1/11 [=&gt;............................] - ETA: 0s - loss: 1950.7905
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
11/11 [==============================] - 0s 2ms/step - loss: 1758.3975 - val_loss: 1943.9243
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 108/200
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 1/11 [=&gt;............................] - ETA: 0s - loss: 1540.4639
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
11/11 [==============================] - 0s 2ms/step - loss: 1764.5607 - val_loss: 1863.3458
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 109/200
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 1/11 [=&gt;............................] - ETA: 0s - loss: 1796.9185
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
11/11 [==============================] - 0s 2ms/step - loss: 1783.8235 - val_loss: 1836.6466
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 110/200
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 1/11 [=&gt;............................] - ETA: 0s - loss: 1390.8413
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
11/11 [==============================] - 0s 2ms/step - loss: 1772.0404 - val_loss: 1908.9185
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 111/200

 1/11 [=&gt;............................] - ETA: 0s - loss: 1270.9514
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
11/11 [==============================] - 0s 2ms/step - loss: 1768.0864 - val_loss: 1861.2192
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 112/200
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 1/11 [=&gt;............................] - ETA: 0s - loss: 1825.5696
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
11/11 [==============================] - 0s 2ms/step - loss: 1749.7592 - val_loss: 1972.8043
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 113/200
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 1/11 [=&gt;............................] - ETA: 0s - loss: 1241.9419
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
11/11 [==============================] - 0s 2ms/step - loss: 1768.4332 - val_loss: 1869.0302
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 114/200

 1/11 [=&gt;............................] - ETA: 0s - loss: 1817.5933
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
11/11 [==============================] - 0s 2ms/step - loss: 1768.1537 - val_loss: 1926.4963
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 115/200
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 1/11 [=&gt;............................] - ETA: 0s - loss: 1373.7103
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
11/11 [==============================] - 0s 2ms/step - loss: 1767.8220 - val_loss: 1938.2419
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 116/200
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 1/11 [=&gt;............................] - ETA: 0s - loss: 2147.4905
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
11/11 [==============================] - 0s 2ms/step - loss: 1756.9836 - val_loss: 1910.8458
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 117/200

 1/11 [=&gt;............................] - ETA: 0s - loss: 2358.7588
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
11/11 [==============================] - 0s 2ms/step - loss: 1773.7568 - val_loss: 1923.8767
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 118/200

 1/11 [=&gt;............................] - ETA: 0s - loss: 1855.0486
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
11/11 [==============================] - 0s 2ms/step - loss: 1767.1818 - val_loss: 1895.8196
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 119/200

 1/11 [=&gt;............................] - ETA: 0s - loss: 2383.0820
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
11/11 [==============================] - 0s 2ms/step - loss: 1757.4525 - val_loss: 1928.9077
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 120/200

 1/11 [=&gt;............................] - ETA: 0s - loss: 2538.7336
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
11/11 [==============================] - 0s 2ms/step - loss: 1747.3027 - val_loss: 1865.0028
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 121/200

 1/11 [=&gt;............................] - ETA: 0s - loss: 2103.4023
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
11/11 [==============================] - 0s 2ms/step - loss: 1752.8761 - val_loss: 1933.8850
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 122/200

 1/11 [=&gt;............................] - ETA: 0s - loss: 1777.6799
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
11/11 [==============================] - 0s 2ms/step - loss: 1763.0833 - val_loss: 1937.4550
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 123/200

 1/11 [=&gt;............................] - ETA: 0s - loss: 1113.3494
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
11/11 [==============================] - 0s 2ms/step - loss: 1729.9114 - val_loss: 1830.6453
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 124/200

 1/11 [=&gt;............................] - ETA: 0s - loss: 1347.5078
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
11/11 [==============================] - 0s 2ms/step - loss: 1757.7932 - val_loss: 1881.7344
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 125/200

 1/11 [=&gt;............................] - ETA: 0s - loss: 1611.9028
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
11/11 [==============================] - 0s 2ms/step - loss: 1761.2147 - val_loss: 1885.3767
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 126/200

 1/11 [=&gt;............................] - ETA: 0s - loss: 1146.2540
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
11/11 [==============================] - 0s 2ms/step - loss: 1748.6776 - val_loss: 1861.6056
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 127/200

 1/11 [=&gt;............................] - ETA: 0s - loss: 2280.9302
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
11/11 [==============================] - 0s 2ms/step - loss: 1737.6406 - val_loss: 1999.9768
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 128/200

 1/11 [=&gt;............................] - ETA: 0s - loss: 2265.3506
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
11/11 [==============================] - 0s 2ms/step - loss: 1761.9011 - val_loss: 1868.0034
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 129/200

 1/11 [=&gt;............................] - ETA: 0s - loss: 2149.2603
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
11/11 [==============================] - 0s 2ms/step - loss: 1764.5021 - val_loss: 1847.0198
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 130/200

 1/11 [=&gt;............................] - ETA: 0s - loss: 1265.2283
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
11/11 [==============================] - 0s 2ms/step - loss: 1762.4760 - val_loss: 1912.3074
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 131/200

 1/11 [=&gt;............................] - ETA: 0s - loss: 1905.9741
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
11/11 [==============================] - 0s 2ms/step - loss: 1739.8699 - val_loss: 1966.9083
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 132/200

 1/11 [=&gt;............................] - ETA: 0s - loss: 793.2422
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
11/11 [==============================] - 0s 2ms/step - loss: 1745.6958 - val_loss: 1850.8114
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 133/200

 1/11 [=&gt;............................] - ETA: 0s - loss: 1466.0981
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
11/11 [==============================] - 0s 2ms/step - loss: 1747.1787 - val_loss: 1881.5859
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 134/200

 1/11 [=&gt;............................] - ETA: 0s - loss: 1694.8735
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
11/11 [==============================] - 0s 2ms/step - loss: 1729.8507 - val_loss: 1938.9708
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 135/200

 1/11 [=&gt;............................] - ETA: 0s - loss: 1748.3513
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
11/11 [==============================] - 0s 2ms/step - loss: 1742.1603 - val_loss: 1856.3998
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 136/200

 1/11 [=&gt;............................] - ETA: 0s - loss: 1453.2440
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
11/11 [==============================] - 0s 2ms/step - loss: 1744.1965 - val_loss: 1850.4088
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 137/200
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 1/11 [=&gt;............................] - ETA: 0s - loss: 1964.7969
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
11/11 [==============================] - 0s 2ms/step - loss: 1740.7031 - val_loss: 1870.7003
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 138/200
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 1/11 [=&gt;............................] - ETA: 0s - loss: 2058.5803
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
11/11 [==============================] - 0s 2ms/step - loss: 1740.3492 - val_loss: 1918.8610
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 139/200
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 1/11 [=&gt;............................] - ETA: 0s - loss: 1329.0903
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
11/11 [==============================] - 0s 2ms/step - loss: 1749.1051 - val_loss: 1863.1335
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 140/200

 1/11 [=&gt;............................] - ETA: 0s - loss: 1650.1404
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
11/11 [==============================] - 0s 2ms/step - loss: 1736.6687 - val_loss: 1835.9537
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 141/200
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 1/11 [=&gt;............................] - ETA: 0s - loss: 1465.7583
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
11/11 [==============================] - 0s 2ms/step - loss: 1752.6534 - val_loss: 1884.5363
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 142/200

 1/11 [=&gt;............................] - ETA: 0s - loss: 1052.2748
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
11/11 [==============================] - 0s 2ms/step - loss: 1726.6967 - val_loss: 1866.7781
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 143/200

 1/11 [=&gt;............................] - ETA: 0s - loss: 1966.7742
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
11/11 [==============================] - 0s 2ms/step - loss: 1737.4771 - val_loss: 1893.9744
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 144/200

 1/11 [=&gt;............................] - ETA: 0s - loss: 2143.7708
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
11/11 [==============================] - 0s 2ms/step - loss: 1738.4434 - val_loss: 1879.3226
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 145/200

 1/11 [=&gt;............................] - ETA: 0s - loss: 1369.8503
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
11/11 [==============================] - 0s 2ms/step - loss: 1728.4713 - val_loss: 1950.9352
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 146/200

 1/11 [=&gt;............................] - ETA: 0s - loss: 1621.8076
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
11/11 [==============================] - 0s 2ms/step - loss: 1751.1427 - val_loss: 1879.2272
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 147/200

 1/11 [=&gt;............................] - ETA: 0s - loss: 2000.0100
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
11/11 [==============================] - 0s 2ms/step - loss: 1737.7223 - val_loss: 1851.2743
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 148/200

 1/11 [=&gt;............................] - ETA: 0s - loss: 1589.3726
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
11/11 [==============================] - 0s 2ms/step - loss: 1733.0638 - val_loss: 1807.8046
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 149/200

 1/11 [=&gt;............................] - ETA: 0s - loss: 2220.3286
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
11/11 [==============================] - 0s 2ms/step - loss: 1749.2423 - val_loss: 1831.2424
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 150/200

 1/11 [=&gt;............................] - ETA: 0s - loss: 1350.5402
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
11/11 [==============================] - 0s 2ms/step - loss: 1737.4186 - val_loss: 1926.4956
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 151/200

 1/11 [=&gt;............................] - ETA: 0s - loss: 2046.1571
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
11/11 [==============================] - 0s 2ms/step - loss: 1746.0814 - val_loss: 1865.7797
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 152/200

 1/11 [=&gt;............................] - ETA: 0s - loss: 1301.4810
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
11/11 [==============================] - 0s 2ms/step - loss: 1738.3965 - val_loss: 1867.0255
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 153/200

 1/11 [=&gt;............................] - ETA: 0s - loss: 1357.1272
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
11/11 [==============================] - 0s 2ms/step - loss: 1729.2021 - val_loss: 1821.6375
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 154/200

 1/11 [=&gt;............................] - ETA: 0s - loss: 1542.6929
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
11/11 [==============================] - 0s 2ms/step - loss: 1737.3936 - val_loss: 1815.5580
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 155/200

 1/11 [=&gt;............................] - ETA: 0s - loss: 1157.7197
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
11/11 [==============================] - 0s 2ms/step - loss: 1755.2238 - val_loss: 1843.1674
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 156/200

 1/11 [=&gt;............................] - ETA: 0s - loss: 1891.3370
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
11/11 [==============================] - 0s 2ms/step - loss: 1733.5054 - val_loss: 1829.0050
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 157/200

 1/11 [=&gt;............................] - ETA: 0s - loss: 1253.1472
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
11/11 [==============================] - 0s 2ms/step - loss: 1736.9469 - val_loss: 1867.5559
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 158/200

 1/11 [=&gt;............................] - ETA: 0s - loss: 2777.4922
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
11/11 [==============================] - 0s 2ms/step - loss: 1748.9720 - val_loss: 1856.4979
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 159/200

 1/11 [=&gt;............................] - ETA: 0s - loss: 2242.5239
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
11/11 [==============================] - 0s 2ms/step - loss: 1729.2772 - val_loss: 1835.0464
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 160/200

 1/11 [=&gt;............................] - ETA: 0s - loss: 2144.0525
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
11/11 [==============================] - 0s 2ms/step - loss: 1725.7805 - val_loss: 1859.4032
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 161/200

 1/11 [=&gt;............................] - ETA: 0s - loss: 1395.0720
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
11/11 [==============================] - 0s 2ms/step - loss: 1741.1271 - val_loss: 1874.4740
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 162/200

 1/11 [=&gt;............................] - ETA: 0s - loss: 1334.8975
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
11/11 [==============================] - 0s 2ms/step - loss: 1728.7759 - val_loss: 1932.2557
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 163/200

 1/11 [=&gt;............................] - ETA: 0s - loss: 1584.9135
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
11/11 [==============================] - 0s 2ms/step - loss: 1732.8539 - val_loss: 1852.9148
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 164/200

 1/11 [=&gt;............................] - ETA: 0s - loss: 1392.4795
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
11/11 [==============================] - 0s 2ms/step - loss: 1723.4172 - val_loss: 1878.1692
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 165/200

 1/11 [=&gt;............................] - ETA: 0s - loss: 1385.6923
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
11/11 [==============================] - 0s 2ms/step - loss: 1747.5927 - val_loss: 1903.7010
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 166/200
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 1/11 [=&gt;............................] - ETA: 0s - loss: 1714.3622
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
11/11 [==============================] - 0s 2ms/step - loss: 1732.5319 - val_loss: 1897.0972
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 167/200
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 1/11 [=&gt;............................] - ETA: 0s - loss: 1810.9930
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
11/11 [==============================] - 0s 2ms/step - loss: 1743.1017 - val_loss: 1886.3589
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 168/200

 1/11 [=&gt;............................] - ETA: 0s - loss: 2052.7600
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
11/11 [==============================] - 0s 2ms/step - loss: 1727.8011 - val_loss: 1833.6074
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 169/200

 1/11 [=&gt;............................] - ETA: 0s - loss: 1532.2926
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
11/11 [==============================] - 0s 2ms/step - loss: 1733.5348 - val_loss: 1880.0686
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 170/200

 1/11 [=&gt;............................] - ETA: 0s - loss: 875.9037
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
11/11 [==============================] - 0s 2ms/step - loss: 1732.8168 - val_loss: 1882.5646
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 171/200

 1/11 [=&gt;............................] - ETA: 0s - loss: 1682.3911
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
11/11 [==============================] - 0s 2ms/step - loss: 1739.1055 - val_loss: 1931.0414
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 172/200

 1/11 [=&gt;............................] - ETA: 0s - loss: 1982.8749
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
11/11 [==============================] - 0s 2ms/step - loss: 1731.1377 - val_loss: 1885.4900
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 173/200

 1/11 [=&gt;............................] - ETA: 0s - loss: 2648.4648
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
11/11 [==============================] - 0s 2ms/step - loss: 1722.6353 - val_loss: 1842.3978
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 174/200

 1/11 [=&gt;............................] - ETA: 0s - loss: 1698.4272
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
11/11 [==============================] - 0s 2ms/step - loss: 1736.7300 - val_loss: 1867.4998
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 175/200

 1/11 [=&gt;............................] - ETA: 0s - loss: 1725.1541
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
11/11 [==============================] - 0s 2ms/step - loss: 1720.1548 - val_loss: 1852.9052
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 176/200

 1/11 [=&gt;............................] - ETA: 0s - loss: 2245.0527
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
11/11 [==============================] - 0s 2ms/step - loss: 1724.2729 - val_loss: 1915.2802
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 177/200

 1/11 [=&gt;............................] - ETA: 0s - loss: 1387.8171
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
11/11 [==============================] - 0s 2ms/step - loss: 1723.6732 - val_loss: 1821.9712
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 178/200

 1/11 [=&gt;............................] - ETA: 0s - loss: 2090.7881
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
11/11 [==============================] - 0s 2ms/step - loss: 1726.7018 - val_loss: 1906.2605
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 179/200

 1/11 [=&gt;............................] - ETA: 0s - loss: 2313.4531
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
11/11 [==============================] - 0s 2ms/step - loss: 1742.9462 - val_loss: 1849.5922
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 180/200

 1/11 [=&gt;............................] - ETA: 0s - loss: 1936.1017
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
11/11 [==============================] - 0s 2ms/step - loss: 1730.5579 - val_loss: 1875.5214
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 181/200

 1/11 [=&gt;............................] - ETA: 0s - loss: 2120.8330
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
11/11 [==============================] - 0s 2ms/step - loss: 1725.2761 - val_loss: 1885.6945
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 182/200

 1/11 [=&gt;............................] - ETA: 0s - loss: 1742.9618
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
11/11 [==============================] - 0s 2ms/step - loss: 1724.4087 - val_loss: 1870.5409
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 183/200

 1/11 [=&gt;............................]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> - ETA: 0s - loss: 1333.5393
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
11/11 [==============================] - 0s 2ms/step - loss: 1745.9879 - val_loss: 1864.5878
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 184/200
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 1/11 [=&gt;............................] - ETA: 0s - loss: 1682.4270
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
11/11 [==============================] - 0s 2ms/step - loss: 1733.2732 - val_loss: 1932.5887
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 185/200
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 1/11 [=&gt;............................] - ETA: 0s - loss: 1616.4133
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
11/11 [==============================] - 0s 2ms/step - loss: 1738.0250 - val_loss: 1824.9524
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 186/200

 1/11 [=&gt;............................] - ETA: 0s - loss: 1907.0491
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
11/11 [==============================] - 0s 2ms/step - loss: 1718.9415 - val_loss: 1838.9901
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 187/200
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 1/11 [=&gt;............................] - ETA: 0s - loss: 1454.1027
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
11/11 [==============================] - 0s 2ms/step - loss: 1744.4996 - val_loss: 1849.1459
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 188/200
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 1/11 [=&gt;............................] - ETA: 0s - loss: 1176.1360
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
11/11 [==============================] - 0s 2ms/step - loss: 1724.7018 - val_loss: 1881.7372
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 189/200
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 1/11 [=&gt;............................] - ETA: 0s - loss: 1834.2332
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
11/11 [==============================] - 0s 2ms/step - loss: 1733.2588 - val_loss: 1868.8346
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 190/200
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 1/11 [=&gt;............................] - ETA: 0s - loss: 1024.6780
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
11/11 [==============================] - 0s 2ms/step - loss: 1728.3688 - val_loss: 1878.5626
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 191/200
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 1/11 [=&gt;............................] - ETA: 0s - loss: 2063.3208
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
11/11 [==============================] - 0s 2ms/step - loss: 1723.8717 - val_loss: 1929.0317
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 192/200
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 1/11 [=&gt;............................] - ETA: 0s - loss: 1628.5276
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
11/11 [==============================] - 0s 2ms/step - loss: 1730.9739 - val_loss: 1843.7885
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 193/200
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 1/11 [=&gt;............................] - ETA: 0s - loss: 1555.4182
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
11/11 [==============================] - 0s 2ms/step - loss: 1719.5646 - val_loss: 1914.3180
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 194/200
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 1/11 [=&gt;............................] - ETA: 0s - loss: 1383.4854
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
11/11 [==============================] - 0s 2ms/step - loss: 1726.8187 - val_loss: 1827.0657
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 195/200

 1/11 [=&gt;............................] - ETA: 0s - loss: 1646.2223
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
11/11 [==============================] - 0s 2ms/step - loss: 1722.6992 - val_loss: 1882.2927
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 196/200

 1/11 [=&gt;............................] - ETA: 0s - loss: 1722.9810
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
11/11 [==============================] - 0s 2ms/step - loss: 1731.8037 - val_loss: 1887.9563
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 197/200

 1/11 [=&gt;............................] - ETA: 0s - loss: 2262.6797
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
11/11 [==============================] - 0s 2ms/step - loss: 1712.6235 - val_loss: 1939.6919
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 198/200

 1/11 [=&gt;............................] - ETA: 0s - loss: 1127.4055
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
11/11 [==============================] - 0s 2ms/step - loss: 1718.8142 - val_loss: 1801.0891
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 199/200

 1/11 [=&gt;............................] - ETA: 0s - loss: 1684.3450
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
11/11 [==============================] - 0s 2ms/step - loss: 1737.7695 - val_loss: 1830.5448
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 200/200

 1/11 [=&gt;............................] - ETA: 0s - loss: 1929.6418
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
11/11 [==============================] - 0s 2ms/step - loss: 1726.5931 - val_loss: 1815.8214
</pre></div>
</div>
</div>
</div>
<p>We can see the additional information given for the loss when applying the current weights of each epoch to the
validation data.
Let’s have a look at it.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">better_history</span><span class="o">.</span><span class="n">history</span><span class="p">[</span><span class="s1">&#39;loss&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;training&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">better_history</span><span class="o">.</span><span class="n">history</span><span class="p">[</span><span class="s1">&#39;val_loss&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;validation&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;loss&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/Python_introduction_230_0.png" src="_images/Python_introduction_230_0.png" />
</div>
</div>
<p>We see a moderate, yet steady decrease in both curves before hitting a plateau of slight oscillation. The graphic shows, that we do not have to deal with over fitting and that our model seems to have converged.</p>
<p>Finally, let’s have a look at the predictions of the trained model again:</p>
<p>There are ways to handle over fitting but we will not discuss them here.</p>
<p>Finally, let’s have a look at the trained model again, using all the data:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y_pred</span> <span class="o">=</span> <span class="n">better_model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">make_data</span><span class="p">(</span><span class="o">-</span><span class="mf">.5</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mf">1.5</span><span class="p">,</span><span class="n">noise</span><span class="o">=</span><span class="kc">False</span><span class="p">),</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y_pred</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/Python_introduction_233_0.png" src="_images/Python_introduction_233_0.png" />
</div>
</div>
<p>At last, we see that our more complex model is very well able to find the underlying function which we used to generate our data.</p>
<p>While we have only covered a tiny bit of TensorFlow and Keras, the syntax stays the same for different kinds of networks. For example, to build a convolutional artificial neural network, we would use <code class="docutils literal notranslate"><span class="pre">keras.Conv2D()</span></code> instead of <code class="docutils literal notranslate"><span class="pre">keras.Dense</span></code>. For more types of layers and how to build more complex architectures, visit the documentation referred to above.</p>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
            



<div class='prev-next-bottom'>
    

</div>
        
        </div>
    </div>
    <footer class="footer">
    <div class="container">
      <p>
        
          By Jan König<br/>
        
            &copy; Copyright 2021.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="_static/js/index.1c5a1a01449ed65a7b51.js"></script>

  
  </body>
</html>